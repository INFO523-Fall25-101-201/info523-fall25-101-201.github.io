<!DOCTYPE html>
<html lang="en"><head>
<link href="../..//images/logo.png" rel="icon" type="image/png">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/tabby.min.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-ea385d0e468b0dd5ea5bf0780b1290d9.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.7.33">

  <title>INFO 523 – Data Preprocessing</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/theme/quarto-191024931916078fc4eae1dde1f53f1c.css">
  <link href="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
  
  <script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<meta property="og:title" content="Data Preprocessing – INFO 523">
<meta property="og:description" content="Data Mining and Discovery">
<meta property="og:site_name" content="INFO 523">
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-image="../minedata-bg.png" data-background-size="600px, cover" data-slide-number="none" class="quarto-title-block center">
  <h1 class="title">Data Preprocessing</h1>
  <p class="subtitle">Data Mining and Discovery</p>

<div class="quarto-title-authors">
</div>

</section>
<section id="setup" class="slide level2">
<h2>Setup</h2>
<div id="setup" class="cell" data-message="false" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a></a><span class="co"># Import all required libraries</span></span>
<span id="cb1-2"><a></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-4"><a></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-5"><a></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-6"><a></a><span class="im">from</span> sklearn.decomposition <span class="im">import</span> PCA</span>
<span id="cb1-7"><a></a><span class="im">from</span> sklearn.manifold <span class="im">import</span> TSNE</span>
<span id="cb1-8"><a></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb1-9"><a></a><span class="im">from</span> sklearn.impute <span class="im">import</span> SimpleImputer</span>
<span id="cb1-10"><a></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb1-11"><a></a><span class="im">import</span> scipy.stats <span class="im">as</span> stats</span>
<span id="cb1-12"><a></a><span class="im">from</span> scipy.stats <span class="im">import</span> gaussian_kde</span>
<span id="cb1-13"><a></a><span class="im">from</span> scipy.signal <span class="im">import</span> find_peaks, argrelextrema</span>
<span id="cb1-14"><a></a><span class="im">from</span> scipy.stats <span class="im">import</span> pearsonr</span>
<span id="cb1-15"><a></a></span>
<span id="cb1-16"><a></a></span>
<span id="cb1-17"><a></a></span>
<span id="cb1-18"><a></a><span class="co"># Increase font size of all Seaborn plot elements</span></span>
<span id="cb1-19"><a></a>sns.<span class="bu">set</span>(font_scale <span class="op">=</span> <span class="fl">1.25</span>)</span>
<span id="cb1-20"><a></a></span>
<span id="cb1-21"><a></a><span class="co"># Set Seaborn theme</span></span>
<span id="cb1-22"><a></a>sns.set_theme(style <span class="op">=</span> <span class="st">"whitegrid"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-preprocessing" class="slide level2">
<h2>Data Preprocessing</h2>
<blockquote>
<p><strong>Data preprocessing</strong> can refer to manipulation, filtration or augmentation of data before it is analyzed, and is often an important step in the <a href="https://en.wikipedia.org/wiki/Data_mining" title="Data mining">data mining</a> process.</p>
</blockquote>
</section>
<section id="datasets" class="slide level2 smaller">
<h2>Datasets</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><strong>Human Freedom Index</strong></p>
<p>The Human Freedom Index is a report that attempts to summarize the idea of “freedom” through variables for many countries around the globe.</p>
<div id="60d1cd3a" class="cell" data-execution_count="3">
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="04-preprocess_files/figure-revealjs/cell-4-output-1.png" width="692" height="307"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<p><strong>Environmental Sustainability</strong></p>
<p>Countries are given an overall sustainability score as well as scores in each of several different environmental areas.</p>
<div id="3b5c87c9" class="cell" data-execution_count="4">
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="04-preprocess_files/figure-revealjs/cell-5-output-1.png" width="700" height="307"></p>
</figure>
</div>
</div>
</div>
</div></div>
</section>
<section id="question" class="slide level2">
<h2>Question</h2>
<p>How does <strong>environmental stability</strong> <u>correlate</u> with <strong>human freedom indices</strong> in <u>different countries</u>, and what <u>trends</u> can be observed over <u>recent years</u>?</p>
</section>
<section id="dataset-1-human-freedom-index" class="slide level2 smaller">
<h2>Dataset #1: Human Freedom Index</h2>
<div id="584479c7" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a></a>hfi <span class="op">=</span> pd.read_csv(<span class="st">"data/hfi.csv"</span>)</span>
<span id="cb2-2"><a></a>hfi.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">ISO_code</th>
<th data-quarto-table-cell-role="th">countries</th>
<th data-quarto-table-cell-role="th">region</th>
<th data-quarto-table-cell-role="th">pf_rol_procedural</th>
<th data-quarto-table-cell-role="th">pf_rol_civil</th>
<th data-quarto-table-cell-role="th">pf_rol_criminal</th>
<th data-quarto-table-cell-role="th">pf_rol</th>
<th data-quarto-table-cell-role="th">pf_ss_homicide</th>
<th data-quarto-table-cell-role="th">pf_ss_disappearances_disap</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">ef_regulation_business_bribes</th>
<th data-quarto-table-cell-role="th">ef_regulation_business_licensing</th>
<th data-quarto-table-cell-role="th">ef_regulation_business_compliance</th>
<th data-quarto-table-cell-role="th">ef_regulation_business</th>
<th data-quarto-table-cell-role="th">ef_regulation</th>
<th data-quarto-table-cell-role="th">ef_score</th>
<th data-quarto-table-cell-role="th">ef_rank</th>
<th data-quarto-table-cell-role="th">hf_score</th>
<th data-quarto-table-cell-role="th">hf_rank</th>
<th data-quarto-table-cell-role="th">hf_quartile</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2016</td>
<td>ALB</td>
<td>Albania</td>
<td>Eastern Europe</td>
<td>6.661503</td>
<td>4.547244</td>
<td>4.666508</td>
<td>5.291752</td>
<td>8.920429</td>
<td>10.0</td>
<td>...</td>
<td>4.050196</td>
<td>7.324582</td>
<td>7.074366</td>
<td>6.705863</td>
<td>6.906901</td>
<td>7.54</td>
<td>34.0</td>
<td>7.568140</td>
<td>48.0</td>
<td>2.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2016</td>
<td>DZA</td>
<td>Algeria</td>
<td>Middle East &amp; North Africa</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>3.819566</td>
<td>9.456254</td>
<td>10.0</td>
<td>...</td>
<td>3.765515</td>
<td>8.523503</td>
<td>7.029528</td>
<td>5.676956</td>
<td>5.268992</td>
<td>4.99</td>
<td>159.0</td>
<td>5.135886</td>
<td>155.0</td>
<td>4.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2016</td>
<td>AGO</td>
<td>Angola</td>
<td>Sub-Saharan Africa</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>3.451814</td>
<td>8.060260</td>
<td>5.0</td>
<td>...</td>
<td>1.945540</td>
<td>8.096776</td>
<td>6.782923</td>
<td>4.930271</td>
<td>5.518500</td>
<td>5.17</td>
<td>155.0</td>
<td>5.640662</td>
<td>142.0</td>
<td>4.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2016</td>
<td>ARG</td>
<td>Argentina</td>
<td>Latin America &amp; the Caribbean</td>
<td>7.098483</td>
<td>5.791960</td>
<td>4.343930</td>
<td>5.744791</td>
<td>7.622974</td>
<td>10.0</td>
<td>...</td>
<td>3.260044</td>
<td>5.253411</td>
<td>6.508295</td>
<td>5.535831</td>
<td>5.369019</td>
<td>4.84</td>
<td>160.0</td>
<td>6.469848</td>
<td>107.0</td>
<td>3.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2016</td>
<td>ARM</td>
<td>Armenia</td>
<td>Caucasus &amp; Central Asia</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>5.003205</td>
<td>8.808750</td>
<td>10.0</td>
<td>...</td>
<td>4.575152</td>
<td>9.319612</td>
<td>6.491481</td>
<td>6.797530</td>
<td>7.378069</td>
<td>7.57</td>
<td>29.0</td>
<td>7.241402</td>
<td>57.0</td>
<td>2.0</td>
</tr>
</tbody>
</table>

<p>5 rows × 123 columns</p>
</div>
</div>
</div>
</section>
<section id="understand-the-data" class="slide level2 smaller">
<h2>Understand the data</h2>
<div class="panel-tabset">
<ul id="tabset-1" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-1-1"><code>.info()</code></a></li><li><a href="#tabset-1-2"><code>.describe()</code></a></li></ul>
<div class="tab-content">
<div id="tabset-1-1">
<div id="3de25c58" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a></a>hfi.info(verbose <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 1458 entries, 0 to 1457
Data columns (total 123 columns):
 #    Column                              Dtype  
---   ------                              -----  
 0    year                                int64  
 1    ISO_code                            object 
 2    countries                           object 
 3    region                              object 
 4    pf_rol_procedural                   float64
 5    pf_rol_civil                        float64
 6    pf_rol_criminal                     float64
 7    pf_rol                              float64
 8    pf_ss_homicide                      float64
 9    pf_ss_disappearances_disap          float64
 10   pf_ss_disappearances_violent        float64
 11   pf_ss_disappearances_organized      float64
 12   pf_ss_disappearances_fatalities     float64
 13   pf_ss_disappearances_injuries       float64
 14   pf_ss_disappearances                float64
 15   pf_ss_women_fgm                     float64
 16   pf_ss_women_missing                 float64
 17   pf_ss_women_inheritance_widows      float64
 18   pf_ss_women_inheritance_daughters   float64
 19   pf_ss_women_inheritance             float64
 20   pf_ss_women                         float64
 21   pf_ss                               float64
 22   pf_movement_domestic                float64
 23   pf_movement_foreign                 float64
 24   pf_movement_women                   float64
 25   pf_movement                         float64
 26   pf_religion_estop_establish         float64
 27   pf_religion_estop_operate           float64
 28   pf_religion_estop                   float64
 29   pf_religion_harassment              float64
 30   pf_religion_restrictions            float64
 31   pf_religion                         float64
 32   pf_association_association          float64
 33   pf_association_assembly             float64
 34   pf_association_political_establish  float64
 35   pf_association_political_operate    float64
 36   pf_association_political            float64
 37   pf_association_prof_establish       float64
 38   pf_association_prof_operate         float64
 39   pf_association_prof                 float64
 40   pf_association_sport_establish      float64
 41   pf_association_sport_operate        float64
 42   pf_association_sport                float64
 43   pf_association                      float64
 44   pf_expression_killed                float64
 45   pf_expression_jailed                float64
 46   pf_expression_influence             float64
 47   pf_expression_control               float64
 48   pf_expression_cable                 float64
 49   pf_expression_newspapers            float64
 50   pf_expression_internet              float64
 51   pf_expression                       float64
 52   pf_identity_legal                   float64
 53   pf_identity_parental_marriage       float64
 54   pf_identity_parental_divorce        float64
 55   pf_identity_parental                float64
 56   pf_identity_sex_male                float64
 57   pf_identity_sex_female              float64
 58   pf_identity_sex                     float64
 59   pf_identity_divorce                 float64
 60   pf_identity                         float64
 61   pf_score                            float64
 62   pf_rank                             float64
 63   ef_government_consumption           float64
 64   ef_government_transfers             float64
 65   ef_government_enterprises           float64
 66   ef_government_tax_income            float64
 67   ef_government_tax_payroll           float64
 68   ef_government_tax                   float64
 69   ef_government                       float64
 70   ef_legal_judicial                   float64
 71   ef_legal_courts                     float64
 72   ef_legal_protection                 float64
 73   ef_legal_military                   float64
 74   ef_legal_integrity                  float64
 75   ef_legal_enforcement                float64
 76   ef_legal_restrictions               float64
 77   ef_legal_police                     float64
 78   ef_legal_crime                      float64
 79   ef_legal_gender                     float64
 80   ef_legal                            float64
 81   ef_money_growth                     float64
 82   ef_money_sd                         float64
 83   ef_money_inflation                  float64
 84   ef_money_currency                   float64
 85   ef_money                            float64
 86   ef_trade_tariffs_revenue            float64
 87   ef_trade_tariffs_mean               float64
 88   ef_trade_tariffs_sd                 float64
 89   ef_trade_tariffs                    float64
 90   ef_trade_regulatory_nontariff       float64
 91   ef_trade_regulatory_compliance      float64
 92   ef_trade_regulatory                 float64
 93   ef_trade_black                      float64
 94   ef_trade_movement_foreign           float64
 95   ef_trade_movement_capital           float64
 96   ef_trade_movement_visit             float64
 97   ef_trade_movement                   float64
 98   ef_trade                            float64
 99   ef_regulation_credit_ownership      float64
 100  ef_regulation_credit_private        float64
 101  ef_regulation_credit_interest       float64
 102  ef_regulation_credit                float64
 103  ef_regulation_labor_minwage         float64
 104  ef_regulation_labor_firing          float64
 105  ef_regulation_labor_bargain         float64
 106  ef_regulation_labor_hours           float64
 107  ef_regulation_labor_dismissal       float64
 108  ef_regulation_labor_conscription    float64
 109  ef_regulation_labor                 float64
 110  ef_regulation_business_adm          float64
 111  ef_regulation_business_bureaucracy  float64
 112  ef_regulation_business_start        float64
 113  ef_regulation_business_bribes       float64
 114  ef_regulation_business_licensing    float64
 115  ef_regulation_business_compliance   float64
 116  ef_regulation_business              float64
 117  ef_regulation                       float64
 118  ef_score                            float64
 119  ef_rank                             float64
 120  hf_score                            float64
 121  hf_rank                             float64
 122  hf_quartile                         float64
dtypes: float64(119), int64(1), object(3)
memory usage: 1.4+ MB</code></pre>
</div>
</div>
</div>
<div id="tabset-1-2">
<div id="399ec15e" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a></a>hfi.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">pf_rol_procedural</th>
<th data-quarto-table-cell-role="th">pf_rol_civil</th>
<th data-quarto-table-cell-role="th">pf_rol_criminal</th>
<th data-quarto-table-cell-role="th">pf_rol</th>
<th data-quarto-table-cell-role="th">pf_ss_homicide</th>
<th data-quarto-table-cell-role="th">pf_ss_disappearances_disap</th>
<th data-quarto-table-cell-role="th">pf_ss_disappearances_violent</th>
<th data-quarto-table-cell-role="th">pf_ss_disappearances_organized</th>
<th data-quarto-table-cell-role="th">pf_ss_disappearances_fatalities</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">ef_regulation_business_bribes</th>
<th data-quarto-table-cell-role="th">ef_regulation_business_licensing</th>
<th data-quarto-table-cell-role="th">ef_regulation_business_compliance</th>
<th data-quarto-table-cell-role="th">ef_regulation_business</th>
<th data-quarto-table-cell-role="th">ef_regulation</th>
<th data-quarto-table-cell-role="th">ef_score</th>
<th data-quarto-table-cell-role="th">ef_rank</th>
<th data-quarto-table-cell-role="th">hf_score</th>
<th data-quarto-table-cell-role="th">hf_rank</th>
<th data-quarto-table-cell-role="th">hf_quartile</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>1458.000000</td>
<td>880.000000</td>
<td>880.000000</td>
<td>880.000000</td>
<td>1378.000000</td>
<td>1378.000000</td>
<td>1369.000000</td>
<td>1378.000000</td>
<td>1279.000000</td>
<td>1378.000000</td>
<td>...</td>
<td>1283.000000</td>
<td>1357.000000</td>
<td>1368.000000</td>
<td>1374.000000</td>
<td>1378.000000</td>
<td>1378.000000</td>
<td>1378.000000</td>
<td>1378.000000</td>
<td>1378.000000</td>
<td>1378.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>2012.000000</td>
<td>5.589355</td>
<td>5.474770</td>
<td>5.044070</td>
<td>5.309641</td>
<td>7.412980</td>
<td>8.341855</td>
<td>9.519458</td>
<td>6.772869</td>
<td>9.584972</td>
<td>...</td>
<td>4.886192</td>
<td>7.698494</td>
<td>6.981858</td>
<td>6.317668</td>
<td>7.019782</td>
<td>6.785610</td>
<td>76.973149</td>
<td>6.993444</td>
<td>77.007983</td>
<td>2.490566</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>2.582875</td>
<td>2.080957</td>
<td>1.428494</td>
<td>1.724886</td>
<td>1.529310</td>
<td>2.832947</td>
<td>3.225902</td>
<td>1.744673</td>
<td>2.768983</td>
<td>1.559826</td>
<td>...</td>
<td>1.889168</td>
<td>1.728507</td>
<td>1.979200</td>
<td>1.230988</td>
<td>1.027625</td>
<td>0.883601</td>
<td>44.540142</td>
<td>1.025811</td>
<td>44.506549</td>
<td>1.119698</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">min</td>
<td>2008.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>2.009841</td>
<td>2.483540</td>
<td>2.880000</td>
<td>1.000000</td>
<td>3.765827</td>
<td>1.000000</td>
<td>1.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25%</td>
<td>2010.000000</td>
<td>4.133333</td>
<td>4.549550</td>
<td>3.789724</td>
<td>4.131746</td>
<td>6.386978</td>
<td>10.000000</td>
<td>10.000000</td>
<td>5.000000</td>
<td>9.942607</td>
<td>...</td>
<td>3.433786</td>
<td>6.874687</td>
<td>6.368178</td>
<td>5.591851</td>
<td>6.429498</td>
<td>6.250000</td>
<td>38.000000</td>
<td>6.336685</td>
<td>39.000000</td>
<td>1.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50%</td>
<td>2012.000000</td>
<td>5.300000</td>
<td>5.300000</td>
<td>4.575189</td>
<td>4.910797</td>
<td>8.638278</td>
<td>10.000000</td>
<td>10.000000</td>
<td>7.500000</td>
<td>10.000000</td>
<td>...</td>
<td>4.418371</td>
<td>8.074161</td>
<td>7.466692</td>
<td>6.265234</td>
<td>7.082075</td>
<td>6.900000</td>
<td>77.000000</td>
<td>6.923840</td>
<td>76.000000</td>
<td>2.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75%</td>
<td>2014.000000</td>
<td>7.389499</td>
<td>6.410975</td>
<td>6.400000</td>
<td>6.513178</td>
<td>9.454402</td>
<td>10.000000</td>
<td>10.000000</td>
<td>10.000000</td>
<td>10.000000</td>
<td>...</td>
<td>6.227978</td>
<td>8.991882</td>
<td>8.209310</td>
<td>7.139718</td>
<td>7.720955</td>
<td>7.410000</td>
<td>115.000000</td>
<td>7.894660</td>
<td>115.000000</td>
<td>3.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>2016.000000</td>
<td>9.700000</td>
<td>8.773533</td>
<td>8.719848</td>
<td>8.723094</td>
<td>9.926568</td>
<td>10.000000</td>
<td>10.000000</td>
<td>10.000000</td>
<td>10.000000</td>
<td>...</td>
<td>9.623811</td>
<td>9.999638</td>
<td>9.865488</td>
<td>9.272600</td>
<td>9.439828</td>
<td>9.190000</td>
<td>162.000000</td>
<td>9.126313</td>
<td>162.000000</td>
<td>4.000000</td>
</tr>
</tbody>
</table>

<p>8 rows × 120 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="identifying-missing-values" class="slide level2 smaller">
<h2>Identifying missing values</h2>
<div id="1b224e9d" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a></a>hfi.isna().<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>year                   0
ISO_code               0
countries              0
region                 0
pf_rol_procedural    578
                    ... 
ef_score              80
ef_rank               80
hf_score              80
hf_rank               80
hf_quartile           80
Length: 123, dtype: int64</code></pre>
</div>
</div>
<div class="fragment">
<blockquote>
<p>A lot of missing values 🙃</p>
</blockquote>
</div>
</section>
<section>
<section id="data-cleaning" class="title-slide slide level1 center">
<h1>Data Cleaning</h1>

</section>
<section id="handling-missing-data" class="slide level2">
<h2>Handling missing data</h2>
<h4 id="options">Options</h4>
<ul>
<li class="fragment">Do nothing…</li>
<li class="fragment">Remove them</li>
<li class="fragment"><strong>Imputate</strong></li>
</ul>
<div class="fragment">
<p>We will be using <code>pf_score</code> from <code>hsi</code>: 80 missing values</p>
</div>
</section>
<section id="imputation" class="slide level2">
<h2>Imputation</h2>
<blockquote>
<p>In <a href="https://en.wikipedia.org/wiki/Statistics" title="Statistics">statistics</a>, <strong>imputation</strong> is the process of replacing <a href="https://en.wikipedia.org/wiki/Missing_data" title="Missing data">missing data</a> with substituted values.</p>
</blockquote>
<div class="fragment">
<h4 id="considerations">Considerations</h4>
<ul>
<li class="fragment">Data distribution</li>
<li class="fragment">Impact on analysis</li>
<li class="fragment">Missing data mechanism</li>
<li class="fragment">Multiple imputation</li>
<li class="fragment">Can also be used on <strong>outliers</strong></li>
</ul>
</div>
</section>
<section id="mean-imputation" class="slide level2 smaller">
<h2>Mean imputation</h2>
<div class="panel-tabset">
<ul id="tabset-2" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-2-1">Definition</a></li><li><a href="#tabset-2-2">Visual</a></li><li><a href="#tabset-2-3">Code</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1">
<p><strong>How it Works</strong>: Replace missing values with the arithmetic <strong>mean</strong> of the non-missing values in the same variable.</p>
<div class="fragment">
<p><strong>Pros</strong>:</p>
<ul>
<li class="fragment">Easy and fast.</li>
<li class="fragment">Works well with small numerical datasets</li>
</ul>
<p><strong>Cons</strong>:</p>
<ul>
<li class="fragment">It only works on the column level.</li>
<li class="fragment">Will give poor results on encoded categorical features.</li>
<li class="fragment">Not very accurate.</li>
<li class="fragment">Doesn’t account for the uncertainty in the imputations.</li>
</ul>
</div>
</div>
<div id="tabset-2-2">
<div id="1cff5d5c" class="cell" data-fig.asp="0.625" data-execution_count="9">
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="04-preprocess_files/figure-revealjs/cell-10-output-1.png" width="824" height="435"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-3">
<div id="f107a161" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb8" data-code-line-numbers="1-12|1|3,4|6,8,10,12"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a></a>hfi_copy <span class="op">=</span> hfi</span>
<span id="cb8-2"><a></a></span>
<span id="cb8-3"><a></a>mean_imputer <span class="op">=</span> SimpleImputer(strategy <span class="op">=</span> <span class="st">'mean'</span>)</span>
<span id="cb8-4"><a></a>hfi_copy[<span class="st">'mean_pf_score'</span>] <span class="op">=</span> mean_imputer.fit_transform(hfi_copy[[<span class="st">'pf_score'</span>]])</span>
<span id="cb8-5"><a></a></span>
<span id="cb8-6"><a></a>mean_plot <span class="op">=</span> sns.kdeplot(data <span class="op">=</span> hfi_copy, x <span class="op">=</span> <span class="st">'pf_score'</span>, linewidth <span class="op">=</span> <span class="dv">2</span>, label <span class="op">=</span> <span class="st">"Original"</span>)</span>
<span id="cb8-7"><a></a></span>
<span id="cb8-8"><a></a>mean_plot <span class="op">=</span> sns.kdeplot(data <span class="op">=</span> hfi_copy, x <span class="op">=</span> <span class="st">'mean_pf_score'</span>, linewidth <span class="op">=</span> <span class="dv">2</span>, label <span class="op">=</span> <span class="st">"Mean Imputated"</span>)</span>
<span id="cb8-9"><a></a></span>
<span id="cb8-10"><a></a>plt.legend()</span>
<span id="cb8-11"><a></a></span>
<span id="cb8-12"><a></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="median-imputation" class="slide level2 smaller">
<h2>Median imputation</h2>
<div class="panel-tabset">
<ul id="tabset-3" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-3-1">Definition</a></li><li><a href="#tabset-3-2">Visual</a></li><li><a href="#tabset-3-3">Code</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1">
<p><strong>How it Works</strong>: Replace missing values with the <strong>median</strong> of the non-missing values in the same variable.</p>
<div class="fragment">
<p><strong>Pros</strong> (same as mean):</p>
<ul>
<li class="fragment">Easy and fast.</li>
<li class="fragment">Works well with small numerical datasets</li>
</ul>
<p><strong>Cons</strong> (same as mean):</p>
<ul>
<li class="fragment">It only works on the column level.</li>
<li class="fragment">Will give poor results on encoded categorical features.</li>
<li class="fragment">Not very accurate.</li>
<li class="fragment">Doesn’t account for the uncertainty in the imputations.</li>
</ul>
</div>
</div>
<div id="tabset-3-2">
<div id="8a9617c1" class="cell" data-fig.asp="0.625" data-ref.label="mean_imp" data-execution_count="11">
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="04-preprocess_files/figure-revealjs/cell-12-output-1.png" width="824" height="435"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-3-3">
<div id="4040c266" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb9" data-code-line-numbers="1-10|1,2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a></a>median_imputer <span class="op">=</span> SimpleImputer(strategy <span class="op">=</span> <span class="st">'median'</span>)</span>
<span id="cb9-2"><a></a>hfi_copy[<span class="st">'median_pf_score'</span>] <span class="op">=</span> median_imputer.fit_transform(hfi_copy[[<span class="st">'pf_score'</span>]])</span>
<span id="cb9-3"><a></a></span>
<span id="cb9-4"><a></a>median_plot <span class="op">=</span> sns.kdeplot(data <span class="op">=</span> hfi_copy, x <span class="op">=</span> <span class="st">'pf_score'</span>, linewidth <span class="op">=</span> <span class="dv">2</span>, label <span class="op">=</span> <span class="st">"Original"</span>)</span>
<span id="cb9-5"><a></a></span>
<span id="cb9-6"><a></a>median_plot <span class="op">=</span> sns.kdeplot(data <span class="op">=</span> hfi_copy, x <span class="op">=</span> <span class="st">'median_pf_score'</span>, linewidth <span class="op">=</span> <span class="dv">2</span>, label <span class="op">=</span> <span class="st">"Median Imputated"</span>)</span>
<span id="cb9-7"><a></a></span>
<span id="cb9-8"><a></a>plt.legend()</span>
<span id="cb9-9"><a></a></span>
<span id="cb9-10"><a></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="mode-imputation" class="slide level2 smaller">
<h2>Mode imputation</h2>
<div class="panel-tabset">
<ul id="tabset-4" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-4-1">Definition</a></li><li><a href="#tabset-4-2">Visual</a></li><li><a href="#tabset-4-3">Code</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1">
<p><strong>How it Works</strong>: Replace missing values with the <strong>mode</strong> of the non-missing values in the same variable.</p>
<div class="fragment">
<p><strong>Pros</strong>:</p>
<ul>
<li class="fragment">Easy and fast.</li>
<li class="fragment">Works well with categorical features.</li>
</ul>
<p><strong>Cons</strong>:</p>
<ul>
<li class="fragment">It also doesn’t factor the correlations between features.</li>
<li class="fragment">It can introduce bias in the data.</li>
</ul>
</div>
</div>
<div id="tabset-4-2">
<div id="ba78dd2c" class="cell" data-fig.asp="0.625" data-execution_count="13">
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="04-preprocess_files/figure-revealjs/cell-14-output-1.png" width="824" height="435"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-4-3">
<div id="bffbcf60" class="cell" data-ref.label="mean-imp" data-execution_count="14">
<div class="sourceCode cell-code" id="cb10" data-code-line-numbers="1-12|1,2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a></a>mode_imputer <span class="op">=</span> SimpleImputer(strategy <span class="op">=</span> <span class="st">'most_frequent'</span>)</span>
<span id="cb10-2"><a></a>hfi_copy[<span class="st">'mode_pf_score'</span>] <span class="op">=</span> mode_imputer.fit_transform(hfi_copy[[<span class="st">'pf_score'</span>]])</span>
<span id="cb10-3"><a></a></span>
<span id="cb10-4"><a></a>mode_plot <span class="op">=</span> sns.kdeplot(data <span class="op">=</span> hfi_copy, x <span class="op">=</span> <span class="st">'pf_score'</span>, linewidth <span class="op">=</span> <span class="dv">2</span>, label <span class="op">=</span> <span class="st">"Original"</span>)</span>
<span id="cb10-5"><a></a></span>
<span id="cb10-6"><a></a>mode_plot <span class="op">=</span> sns.kdeplot(data <span class="op">=</span> hfi_copy, x <span class="op">=</span> <span class="st">'mode_pf_score'</span>, linewidth <span class="op">=</span> <span class="dv">2</span>, label <span class="op">=</span> <span class="st">"Mode Imputated"</span>)</span>
<span id="cb10-7"><a></a></span>
<span id="cb10-8"><a></a>plt.legend()</span>
<span id="cb10-9"><a></a></span>
<span id="cb10-10"><a></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="capping-winsorizing-imputation" class="slide level2 smaller">
<h2>Capping (Winsorizing) imputation</h2>
<div class="panel-tabset">
<ul id="tabset-5" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-5-1">Definition</a></li><li><a href="#tabset-5-2">Visual</a></li><li><a href="#tabset-5-3">Code</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1">
<p><strong>How it Works</strong>: Removing extreme values, or <strong>outliers</strong> based on cut-offs</p>
<div class="fragment">
<p><strong>Pros</strong>:</p>
<ul>
<li class="fragment">Not influenced by extreme values</li>
</ul>
<p><strong>Cons</strong>:</p>
<ul>
<li class="fragment">Capping only modifies the smallest and largest values slightly.</li>
<li class="fragment">If no extreme outliers are present, Winsorization may be unnecessary.</li>
</ul>
</div>
</div>
<div id="tabset-5-2">
<div id="676fc21d" class="cell" data-fig.asp="0.625" data-execution_count="15">
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="04-preprocess_files/figure-revealjs/cell-16-output-1.png" width="824" height="435"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-5-3">
<div id="90d15b06" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb11" data-code-line-numbers="1-12|1,2,4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a></a>upper_limit <span class="op">=</span> np.percentile(hfi_copy[<span class="st">'pf_score'</span>].dropna(), <span class="dv">95</span>)</span>
<span id="cb11-2"><a></a>lower_limit <span class="op">=</span> np.percentile(hfi_copy[<span class="st">'pf_score'</span>].dropna(), <span class="dv">5</span>)</span>
<span id="cb11-3"><a></a></span>
<span id="cb11-4"><a></a>hfi_copy[<span class="st">'capped_pf_score'</span>] <span class="op">=</span> np.clip(hfi_copy[<span class="st">'pf_score'</span>], lower_limit, upper_limit)</span>
<span id="cb11-5"><a></a></span>
<span id="cb11-6"><a></a>cap_plot <span class="op">=</span> sns.kdeplot(data <span class="op">=</span> hfi_copy, x <span class="op">=</span> <span class="st">'pf_score'</span>, linewidth <span class="op">=</span> <span class="dv">2</span>, label <span class="op">=</span> <span class="st">"Original"</span>)</span>
<span id="cb11-7"><a></a></span>
<span id="cb11-8"><a></a>cap_plot <span class="op">=</span> sns.kdeplot(data <span class="op">=</span> hfi_copy, x <span class="op">=</span> <span class="st">'capped_pf_score'</span>, linewidth <span class="op">=</span> <span class="dv">2</span>, label <span class="op">=</span> <span class="st">"Mode Imputated"</span>)</span>
<span id="cb11-9"><a></a></span>
<span id="cb11-10"><a></a>plt.legend()</span>
<span id="cb11-11"><a></a></span>
<span id="cb11-12"><a></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="other-imputation-methods" class="slide level2 smaller">
<h2>Other Imputation Methods</h2>
<div style="text-align: center;">
<iframe width="1200" height="400" src="https://datamineaz.org/tables/model-cheatsheet.html" frameborder="1" style="background:white;"></iframe>
</div>
</section>
<section id="data-type-conversion" class="slide level2 smaller">
<h2>Data type conversion</h2>
<div id="9d00d1eb" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a></a>hfi[<span class="st">'year'</span>] <span class="op">=</span> pd.to_datetime(hfi[<span class="st">'year'</span>], <span class="bu">format</span><span class="op">=</span><span class="st">'%Y'</span>)</span>
<span id="cb12-2"><a></a></span>
<span id="cb12-3"><a></a>hfi.head(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">ISO_code</th>
<th data-quarto-table-cell-role="th">countries</th>
<th data-quarto-table-cell-role="th">region</th>
<th data-quarto-table-cell-role="th">pf_rol_procedural</th>
<th data-quarto-table-cell-role="th">pf_rol_civil</th>
<th data-quarto-table-cell-role="th">pf_rol_criminal</th>
<th data-quarto-table-cell-role="th">pf_rol</th>
<th data-quarto-table-cell-role="th">pf_ss_homicide</th>
<th data-quarto-table-cell-role="th">pf_ss_disappearances_disap</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">ef_regulation</th>
<th data-quarto-table-cell-role="th">ef_score</th>
<th data-quarto-table-cell-role="th">ef_rank</th>
<th data-quarto-table-cell-role="th">hf_score</th>
<th data-quarto-table-cell-role="th">hf_rank</th>
<th data-quarto-table-cell-role="th">hf_quartile</th>
<th data-quarto-table-cell-role="th">mean_pf_score</th>
<th data-quarto-table-cell-role="th">median_pf_score</th>
<th data-quarto-table-cell-role="th">mode_pf_score</th>
<th data-quarto-table-cell-role="th">capped_pf_score</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2016-01-01</td>
<td>ALB</td>
<td>Albania</td>
<td>Eastern Europe</td>
<td>6.661503</td>
<td>4.547244</td>
<td>4.666508</td>
<td>5.291752</td>
<td>8.920429</td>
<td>10.0</td>
<td>...</td>
<td>6.906901</td>
<td>7.54</td>
<td>34.0</td>
<td>7.56814</td>
<td>48.0</td>
<td>2.0</td>
<td>7.596281</td>
<td>7.596281</td>
<td>7.596281</td>
<td>7.596281</td>
</tr>
</tbody>
</table>

<p>1 rows × 127 columns</p>
</div>
</div>
</div>
<div id="105d32e2" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a></a>hfi.dtypes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>year                 datetime64[ns]
ISO_code                     object
countries                    object
region                       object
pf_rol_procedural           float64
                          ...      
hf_quartile                 float64
mean_pf_score               float64
median_pf_score             float64
mode_pf_score               float64
capped_pf_score             float64
Length: 127, dtype: object</code></pre>
</div>
</div>
</section>
<section id="removing-duplicates" class="slide level2 smaller">
<h2>Removing duplicates</h2>
<div id="a5b0d971" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a></a>hfi.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 1458 entries, 0 to 1457
Columns: 127 entries, year to capped_pf_score
dtypes: datetime64[ns](1), float64(123), object(3)
memory usage: 1.4+ MB</code></pre>
</div>
</div>
<div id="3218f5a6" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a></a>hfi.drop_duplicates(inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb17-2"><a></a>hfi.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 1458 entries, 0 to 1457
Columns: 127 entries, year to capped_pf_score
dtypes: datetime64[ns](1), float64(123), object(3)
memory usage: 1.4+ MB</code></pre>
</div>
</div>
<div class="fragment">
<blockquote>
<p>No duplicates! 😊</p>
</blockquote>
</div>
</section>
<section id="filtering-data" class="slide level2 smaller">
<h2>Filtering data</h2>
<div class="panel-tabset">
<ul id="tabset-6" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-6-1">Category</a></li><li><a href="#tabset-6-2">Numeric</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1">
<p>Let’s look at USA, India, Canada, China</p>
<div id="17b3056f" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb19" data-code-line-numbers="1-6|1|2|5,6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a></a>options <span class="op">=</span> [<span class="st">'United States'</span>, <span class="st">'India'</span>, <span class="st">'Canada'</span>, <span class="st">'China'</span>]</span>
<span id="cb19-2"><a></a></span>
<span id="cb19-3"><a></a>filtered_hfi <span class="op">=</span> hfi[hfi[<span class="st">'countries'</span>].isin(options)]</span>
<span id="cb19-4"><a></a></span>
<span id="cb19-5"><a></a>unique_countries <span class="op">=</span> filtered_hfi[<span class="st">'countries'</span>].unique()</span>
<span id="cb19-6"><a></a><span class="bu">print</span>(unique_countries)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>['Canada' 'China' 'India' 'United States']</code></pre>
</div>
</div>
</div>
<div id="tabset-6-2">
<p>Let’s look at <a href="https://www.investopedia.com/terms/i/index-of-economic-freedom.asp#:~:text=An%20index%20of%20economic%20freedom%20is%20a%20composite,criteria%20such%20as%20property%20rights%20and%20tax%20burden.">Economic Freedom</a> &gt; 75</p>
<div id="44e52f90" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb21" data-code-line-numbers="1-3|1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a></a>filtered_hfi <span class="op">=</span> hfi[hfi[<span class="st">'pf_score'</span>] <span class="op">&gt;</span> <span class="dv">8</span>]</span>
<span id="cb21-2"><a></a>sns.boxplot(filtered_hfi, x <span class="op">=</span> <span class="st">"pf_score"</span>, y <span class="op">=</span> <span class="st">"countries"</span>, palette <span class="op">=</span> <span class="st">"colorblind"</span>)</span>
<span id="cb21-3"><a></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="04-preprocess_files/figure-revealjs/cell-23-output-1.png" width="956" height="437"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section></section>
<section>
<section id="transformations" class="title-slide slide level1 center">
<h1>Transformations</h1>

</section>
<section id="normalizing" class="slide level2 smaller">
<h2>Normalizing</h2>
<div class="panel-tabset">
<ul id="tabset-7" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-7-1">Standard Deviation</a></li><li><a href="#tabset-7-2">Z-Score Normalization</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1">
<div id="14a21c9e" class="cell" data-execution_count="23">
<div class="cell-output cell-output-stdout">
<pre><code>Mean: 5
Standard Deviation: 2</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="04-preprocess_files/figure-revealjs/cell-24-output-2.png" width="832" height="442"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-7-2">
<div id="0f645679" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb23" data-code-line-numbers="1-6|3,4|5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a></a>hfi_copy <span class="op">=</span> hfi</span>
<span id="cb23-2"><a></a></span>
<span id="cb23-3"><a></a>scaler <span class="op">=</span> StandardScaler()</span>
<span id="cb23-4"><a></a>hfi_copy[[<span class="st">'ef_score_scale'</span>, <span class="st">'pf_score_scale'</span>]] <span class="op">=</span> scaler.fit_transform(hfi_copy[[<span class="st">'ef_score'</span>, <span class="st">'pf_score'</span>]])</span>
<span id="cb23-5"><a></a></span>
<span id="cb23-6"><a></a>hfi_copy[[<span class="st">'ef_score_scale'</span>, <span class="st">'pf_score_scale'</span>]].describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ef_score_scale</th>
<th data-quarto-table-cell-role="th">pf_score_scale</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>1.378000e+03</td>
<td>1.378000e+03</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>4.524683e-16</td>
<td>2.062533e-17</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>1.000363e+00</td>
<td>1.000363e+00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">min</td>
<td>-4.421711e+00</td>
<td>-3.663087e+00</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25%</td>
<td>-6.063870e-01</td>
<td>-7.303950e-01</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50%</td>
<td>1.295064e-01</td>
<td>-8.926277e-03</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75%</td>
<td>7.068997e-01</td>
<td>9.081441e-01</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>2.722116e+00</td>
<td>1.722056e+00</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="normality-test-q-q-plot" class="slide level2 smaller">
<h2>Normality test: Q-Q plot</h2>
<div class="panel-tabset">
<ul id="tabset-8" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-8-1">Q-Q Plot</a></li><li><a href="#tabset-8-2">Issues</a></li></ul>
<div class="tab-content">
<div id="tabset-8-1">
<div id="1c47420a" class="cell" data-execution_count="25">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a></a>hfi_clean <span class="op">=</span> hfi_copy.dropna(subset <span class="op">=</span> [<span class="st">'pf_score'</span>])</span>
<span id="cb24-2"><a></a></span>
<span id="cb24-3"><a></a>sns.set_style(<span class="st">"white"</span>)</span>
<span id="cb24-4"><a></a></span>
<span id="cb24-5"><a></a>fig, (ax1, ax2) <span class="op">=</span> plt.subplots(ncols <span class="op">=</span> <span class="dv">2</span>, nrows <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb24-6"><a></a></span>
<span id="cb24-7"><a></a>sns.kdeplot(data <span class="op">=</span> hfi_clean, x <span class="op">=</span> <span class="st">"pf_score"</span>, linewidth <span class="op">=</span> <span class="dv">5</span>, ax <span class="op">=</span> ax1)</span>
<span id="cb24-8"><a></a>ax1.set_title(<span class="st">'Personal Freedom Score'</span>)</span>
<span id="cb24-9"><a></a></span>
<span id="cb24-10"><a></a>sm.qqplot(hfi_clean[<span class="st">'pf_score'</span>], line <span class="op">=</span> <span class="st">'s'</span>, ax <span class="op">=</span> ax2, dist <span class="op">=</span> stats.norm, fit <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb24-11"><a></a>ax2.set_title(<span class="st">'Personal Freedom Score Q-Q plot'</span>)</span>
<span id="cb24-12"><a></a></span>
<span id="cb24-13"><a></a>plt.tight_layout()</span>
<span id="cb24-14"><a></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="04-preprocess_files/figure-revealjs/cell-26-output-1.png" width="937" height="454"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-8-2">
<p><strong>There were some issues in our plots</strong>:</p>
<ul>
<li class="fragment"><p><strong>Left Tail</strong>: Points deviate downwards from the line, indicating more extreme low values than a normal distribution (<strong>negative skewness</strong>).</p></li>
<li class="fragment"><p><strong>Central Section</strong>: Points align closely with the line, suggesting the central data is <em>similar to a normal distribution</em>.</p></li>
<li class="fragment"><p><strong>Right Tail</strong>: Points curve upwards, showing potential for <strong>extreme high values (positive skewness)</strong>.</p></li>
</ul>
</div>
</div>
</div>
</section>
<section id="correcting-skew" class="slide level2 smaller">
<h2>Correcting skew</h2>
<div class="fragment">
<p><a href="https://en.wikipedia.org/wiki/Square_root">Square-root transformation</a>. <span class="math inline">\(\sqrt x\)</span> Used for <strong>moderately</strong> right-skew <strong>(positive skew)</strong></p>
<ul>
<li class="fragment">Cannot handle negative values (but can handle zeros)</li>
</ul>
</div>
<div class="fragment">
<p><a href="https://en.wikipedia.org/wiki/Logarithm">Log transformation</a>. <span class="math inline">\(log(x + 1)\)</span> Used for <strong>substantial</strong> right-skew <strong>(positive skew)</strong></p>
<ul>
<li class="fragment">Cannot handle negative or zero values</li>
</ul>
</div>
<div class="fragment">
<p><a href="https://en.wikipedia.org/wiki/Inverse_function">Inverse transformation</a>. <span class="math inline">\(\frac{1}{x}\)</span> Used for <strong>severe</strong> right-skew <strong>(positive skew)</strong></p>
<ul>
<li class="fragment">Cannot handle negative or zero values</li>
</ul>
</div>
<div class="fragment">
<p><a href="https://en.wikipedia.org/wiki/Quadratic_function">Squared transformation</a>. <span class="math inline">\(x^2\)</span> Used for <strong>moderately</strong> left-skew <strong>(negative skew)</strong></p>
<ul>
<li class="fragment">Effective when lower values are densely packed together</li>
</ul>
</div>
<div class="fragment">
<p><a href="https://en.wikipedia.org/wiki/Cubic_function">Cubed transformation</a>. <span class="math inline">\(x^3\)</span> Used for <strong>severely</strong> left-skew <strong>(negative skew)</strong></p>
<ul>
<li class="fragment">Further stretches the tail of the distribution</li>
</ul>
</div>
</section>
<section id="comparing-transformations" class="slide level2 smaller">
<h2>Comparing transformations</h2>
<div class="panel-tabset">
<ul id="tabset-9" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-9-1">Original</a></li><li><a href="#tabset-9-2">Square-root</a></li><li><a href="#tabset-9-3">Log</a></li><li><a href="#tabset-9-4">Inverse</a></li><li><a href="#tabset-9-5">Squared</a></li><li><a href="#tabset-9-6">Cubed</a></li></ul>
<div class="tab-content">
<div id="tabset-9-1">
<div id="d83733bd" class="cell" data-execution_count="26">
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="04-preprocess_files/figure-revealjs/cell-27-output-1.png" width="937" height="454"></p>
</figure>
</div>
</div>
</div>
<div class="fragment">
<p><strong>Moderate negative skew, no zeros or negative values</strong></p>
</div>
</div>
<div id="tabset-9-2">
<div id="81a668a9" class="cell" data-execution_count="27">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25" data-code-line-numbers="1-13|1|2,7,10"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a></a>hfi_clean[<span class="st">'pf_score_sqrt'</span>] <span class="op">=</span> np.sqrt(hfi_clean[<span class="st">'pf_score'</span>])</span>
<span id="cb25-2"><a></a></span>
<span id="cb25-3"><a></a>col <span class="op">=</span> hfi_clean[<span class="st">'pf_score_sqrt'</span>]</span>
<span id="cb25-4"><a></a></span>
<span id="cb25-5"><a></a>fig, (ax1, ax2) <span class="op">=</span> plt.subplots(ncols <span class="op">=</span> <span class="dv">2</span>, nrows <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb25-6"><a></a></span>
<span id="cb25-7"><a></a>sns.kdeplot(col, linewidth <span class="op">=</span> <span class="dv">5</span>, ax <span class="op">=</span> ax1)</span>
<span id="cb25-8"><a></a>ax1.set_title(<span class="st">'Square-root Density plot'</span>)    </span>
<span id="cb25-9"><a></a></span>
<span id="cb25-10"><a></a>sm.qqplot(col, line <span class="op">=</span> <span class="st">'s'</span>, ax <span class="op">=</span> ax2)</span>
<span id="cb25-11"><a></a>ax2.set_title(<span class="st">'Square-root Q-Q plot'</span>)    </span>
<span id="cb25-12"><a></a>plt.tight_layout()</span>
<span id="cb25-13"><a></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="04-preprocess_files/figure-revealjs/cell-28-output-1.png" width="937" height="454"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-9-3">
<div id="97fa95f6" class="cell" data-execution_count="28">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26" data-code-line-numbers="1-13|1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a></a>hfi_clean[<span class="st">'pf_score_log'</span>] <span class="op">=</span> np.log(hfi_clean[<span class="st">'pf_score'</span>] <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb26-2"><a></a></span>
<span id="cb26-3"><a></a>col <span class="op">=</span> hfi_clean[<span class="st">'pf_score_log'</span>]</span>
<span id="cb26-4"><a></a></span>
<span id="cb26-5"><a></a>fig, (ax1, ax2) <span class="op">=</span> plt.subplots(ncols <span class="op">=</span> <span class="dv">2</span>, nrows <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb26-6"><a></a></span>
<span id="cb26-7"><a></a>sns.kdeplot(col, linewidth <span class="op">=</span> <span class="dv">5</span>, ax <span class="op">=</span> ax1)</span>
<span id="cb26-8"><a></a>ax1.set_title(<span class="st">'Log Density plot'</span>)    </span>
<span id="cb26-9"><a></a></span>
<span id="cb26-10"><a></a>sm.qqplot(col, line <span class="op">=</span> <span class="st">'s'</span>, ax <span class="op">=</span> ax2)</span>
<span id="cb26-11"><a></a>ax2.set_title(<span class="st">'Log Q-Q plot'</span>)    </span>
<span id="cb26-12"><a></a>plt.tight_layout()</span>
<span id="cb26-13"><a></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="04-preprocess_files/figure-revealjs/cell-29-output-1.png" width="937" height="454"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-9-4">
<div id="6cc126ab" class="cell" data-execution_count="29">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27" data-code-line-numbers="1-13|1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a></a>hfi_clean[<span class="st">'pf_score_inv'</span>] <span class="op">=</span> <span class="dv">1</span><span class="op">/</span>hfi_clean.pf_score</span>
<span id="cb27-2"><a></a></span>
<span id="cb27-3"><a></a>col <span class="op">=</span> hfi_clean[<span class="st">'pf_score_inv'</span>]</span>
<span id="cb27-4"><a></a></span>
<span id="cb27-5"><a></a>fig, (ax1, ax2) <span class="op">=</span> plt.subplots(ncols <span class="op">=</span> <span class="dv">2</span>, nrows <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb27-6"><a></a></span>
<span id="cb27-7"><a></a>sns.kdeplot(col, linewidth <span class="op">=</span> <span class="dv">5</span>, ax <span class="op">=</span> ax1)</span>
<span id="cb27-8"><a></a>ax1.set_title(<span class="st">'Inverse Density plot'</span>)    </span>
<span id="cb27-9"><a></a></span>
<span id="cb27-10"><a></a>sm.qqplot(col, line <span class="op">=</span> <span class="st">'s'</span>, ax <span class="op">=</span> ax2)</span>
<span id="cb27-11"><a></a>ax2.set_title(<span class="st">'Inverse Q-Q plot'</span>)    </span>
<span id="cb27-12"><a></a>plt.tight_layout()</span>
<span id="cb27-13"><a></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="04-preprocess_files/figure-revealjs/cell-30-output-1.png" width="937" height="454"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-9-5">
<div id="8a65388a" class="cell" data-execution_count="30">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28" data-code-line-numbers="1-13|1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a></a>hfi_clean[<span class="st">'pf_score_square'</span>] <span class="op">=</span> <span class="bu">pow</span>(hfi_clean.pf_score, <span class="dv">2</span>)</span>
<span id="cb28-2"><a></a></span>
<span id="cb28-3"><a></a>col <span class="op">=</span> hfi_clean[<span class="st">'pf_score_square'</span>]</span>
<span id="cb28-4"><a></a></span>
<span id="cb28-5"><a></a>fig, (ax1, ax2) <span class="op">=</span> plt.subplots(ncols <span class="op">=</span> <span class="dv">2</span>, nrows <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb28-6"><a></a></span>
<span id="cb28-7"><a></a>sns.kdeplot(col, linewidth <span class="op">=</span> <span class="dv">5</span>, ax <span class="op">=</span> ax1)</span>
<span id="cb28-8"><a></a>ax1.set_title(<span class="st">'Squared Density plot'</span>)    </span>
<span id="cb28-9"><a></a></span>
<span id="cb28-10"><a></a>sm.qqplot(col, line <span class="op">=</span> <span class="st">'s'</span>, ax <span class="op">=</span> ax2)</span>
<span id="cb28-11"><a></a>ax2.set_title(<span class="st">'Squared Q-Q plot'</span>)    </span>
<span id="cb28-12"><a></a>plt.tight_layout()</span>
<span id="cb28-13"><a></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="04-preprocess_files/figure-revealjs/cell-31-output-1.png" width="937" height="454"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-9-6">
<div id="08951e1d" class="cell" data-execution_count="31">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29" data-code-line-numbers="1-13|1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a></a>hfi_clean[<span class="st">'pf_score_cube'</span>] <span class="op">=</span> <span class="bu">pow</span>(hfi_clean.pf_score, <span class="dv">3</span>)</span>
<span id="cb29-2"><a></a></span>
<span id="cb29-3"><a></a>col <span class="op">=</span> hfi_clean[<span class="st">'pf_score_cube'</span>]</span>
<span id="cb29-4"><a></a></span>
<span id="cb29-5"><a></a>fig, (ax1, ax2) <span class="op">=</span> plt.subplots(ncols <span class="op">=</span> <span class="dv">2</span>, nrows <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb29-6"><a></a></span>
<span id="cb29-7"><a></a>sns.kdeplot(col, linewidth <span class="op">=</span> <span class="dv">5</span>, ax <span class="op">=</span> ax1)</span>
<span id="cb29-8"><a></a>ax1.set_title(<span class="st">'Cubed Density plot'</span>)    </span>
<span id="cb29-9"><a></a></span>
<span id="cb29-10"><a></a>sm.qqplot(col, line <span class="op">=</span> <span class="st">'s'</span>, ax <span class="op">=</span> ax2)</span>
<span id="cb29-11"><a></a>ax2.set_title(<span class="st">'Cubed Q-Q plot'</span>)    </span>
<span id="cb29-12"><a></a>plt.tight_layout()</span>
<span id="cb29-13"><a></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="04-preprocess_files/figure-revealjs/cell-32-output-1.png" width="937" height="454"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="what-did-we-learn" class="slide level2">
<h2>What did we learn?</h2>
<ul>
<li class="fragment"><p>Negative skew excluded all but <strong>Squared</strong> and <strong>Cubed</strong> transformations</p></li>
<li class="fragment"><p><strong>Squared</strong> transformation was the best</p></li>
<li class="fragment"><p>The data is <strong>bimodal</strong>, so no transformation is perfect</p></li>
</ul>
</section>
<section id="dealing-with-multimodality" class="slide level2">
<h2>Dealing with multimodality</h2>
<ul>
<li class="fragment"><p>K-Means Clustering</p>
<ul>
<li class="fragment">We will learn this later</li>
</ul></li>
<li class="fragment"><p>Gaussian Mixture Models</p>
<ul>
<li class="fragment">Also later</li>
</ul></li>
<li class="fragment"><p>Thresholding</p>
<ul>
<li class="fragment">No obvious valley</li>
</ul></li>
<li class="fragment"><p>Domain knowledge</p>
<ul>
<li class="fragment">None that is applicable</li>
</ul></li>
<li class="fragment"><p><a href="https://en.wikipedia.org/wiki/Kernel_density_estimation"><strong>Kernel Density Estimation (KDE)</strong></a></p></li>
</ul>
</section>
<section id="kernel-density-estimation-kde" class="slide level2 smaller">
<h2>Kernel Density Estimation (KDE)</h2>
<p><strong>Finding valleys in multimodal data, then splitting</strong></p>
<p><span class="math display">\[\hat{f}(x) = \frac{1}{n h} \sum_{i=1}^{n} K\left(\frac{x - x_i}{h}\right)\]</span></p>
<ul>
<li class="fragment"><p><span class="math inline">\(\hat{f}(x)\)</span> is the estimated probability density function at point <span class="math inline">\(x\)</span>.</p></li>
<li class="fragment"><p><span class="math inline">\(n\)</span> is the number of data points.</p></li>
<li class="fragment"><p><span class="math inline">\(x_i\)</span> are the observed data points.</p></li>
<li class="fragment"><p><span class="math inline">\(h\)</span> is the bandwidth.</p></li>
<li class="fragment"><p><span class="math inline">\(K\)</span> is the kernel function, which is a non-negative function that integrates to one and is symmetric around zero.</p></li>
</ul>
<div class="fragment">
<p>The choice of <span class="math inline">\(h\)</span> and <span class="math inline">\(K\)</span> can significantly affect the resulting estimate.</p>
</div>
<div class="fragment">
<p>Common choices for the kernel function <span class="math inline">\(K\)</span> include the <a href="https://en.wikipedia.org/wiki/Kernel_smoother#Gaussian_kernel_smoother"><strong>Gaussian kernel</strong></a> and <a href="https://www.gabormelli.com/RKB/Epanechnikov_Kernel#:~:text=An%20Epanechnikov%20Kernel%20is%20a%20kernel%20function%20that,be%20optimal%20with%20respect%20to%20Mean%20Square%20Error.">Epanechnikov kernel</a></p>
</div>
</section>
<section id="kde-bandwidth-method" class="slide level2 smaller">
<h2>KDE: bandwidth method</h2>
<p><strong>In density estimations, there is a smoothing parameter</strong></p>
<div class="fragment">
<p><strong>Scott’s Rule</strong></p>
<ul>
<li class="fragment">Rule of thumb for choosing kernal bandwidth</li>
<li class="fragment">Proportional to the standard deviation of the data and inversely proportional to the cube root of the sample size (n).</li>
<li class="fragment">Formula: <span class="math inline">\(h = \sigma \cdot n^{-\frac{1}{3}}\)</span></li>
<li class="fragment">Tends to produce a smoother density estimation</li>
<li class="fragment">Suitable for data that is roughly normally distributed</li>
</ul>
</div>
<div class="fragment">
<p><strong>Silverman’s Rule</strong></p>
<ul>
<li class="fragment">Another popular rule of thumb</li>
<li class="fragment">Similar to Scott’s rule but potentially leading to a smaller bandwidth.</li>
<li class="fragment">Formula: <span class="math inline">\(h = \left( \frac{4\hat{\sigma}^5}{3n} \right)^{\frac{1}{5}}\)</span></li>
<li class="fragment">Can be better for data with outliers or heavy tails</li>
</ul>
</div>
</section>
<section id="kde-our-data" class="slide level2 smaller">
<h2>KDE: our data</h2>
<div id="235590be" class="cell" data-execution_count="32">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30" data-code-line-numbers="1-16|1-4|6,7|12|16"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a></a>values <span class="op">=</span> hfi_clean[<span class="st">'pf_score_square'</span>]</span>
<span id="cb30-2"><a></a>kde <span class="op">=</span> gaussian_kde(values, bw_method <span class="op">=</span> <span class="st">'scott'</span>)</span>
<span id="cb30-3"><a></a>x_eval <span class="op">=</span> np.linspace(values.<span class="bu">min</span>(), values.<span class="bu">max</span>(), num <span class="op">=</span> <span class="dv">500</span>) </span>
<span id="cb30-4"><a></a>kde_values <span class="op">=</span> kde(x_eval)</span>
<span id="cb30-5"><a></a></span>
<span id="cb30-6"><a></a>minima_indices <span class="op">=</span> argrelextrema(kde_values, np.less)[<span class="dv">0</span>]</span>
<span id="cb30-7"><a></a>valleys <span class="op">=</span> x_eval[minima_indices]</span>
<span id="cb30-8"><a></a></span>
<span id="cb30-9"><a></a>plt.figure(figsize <span class="op">=</span> (<span class="dv">7</span>, <span class="dv">5</span>))</span>
<span id="cb30-10"><a></a>plt.title(<span class="st">'KDE and Valleys'</span>)</span>
<span id="cb30-11"><a></a>sns.lineplot(x <span class="op">=</span> x_eval, y <span class="op">=</span> kde_values, label <span class="op">=</span> <span class="st">'KDE'</span>)</span>
<span id="cb30-12"><a></a>plt.scatter(x <span class="op">=</span> valleys, y <span class="op">=</span> kde(valleys), color <span class="op">=</span> <span class="st">'r'</span>, zorder <span class="op">=</span> <span class="dv">5</span>, label <span class="op">=</span> <span class="st">'Valleys'</span>)</span>
<span id="cb30-13"><a></a>plt.legend()</span>
<span id="cb30-14"><a></a>plt.show()</span>
<span id="cb30-15"><a></a></span>
<span id="cb30-16"><a></a><span class="bu">print</span>(<span class="st">"Valley x-values:"</span>, valleys)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="04-preprocess_files/figure-revealjs/cell-33-output-1.png" width="605" height="438"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Valley x-values: [68.39968248]</code></pre>
</div>
</div>
</section>
<section id="split-the-data" class="slide level2 smaller">
<h2>Split the data</h2>
<div id="49cd487c" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb32" data-code-line-numbers="1-5|1,2|4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a></a>valley <span class="op">=</span> <span class="fl">68.39968248</span></span>
<span id="cb32-2"><a></a>hfi_clean[<span class="st">'group'</span>] <span class="op">=</span> np.where(hfi_clean[<span class="st">'pf_score_square'</span>] <span class="op">&lt;</span> valley, <span class="st">'group1'</span>, <span class="st">'group2'</span>)</span>
<span id="cb32-3"><a></a></span>
<span id="cb32-4"><a></a>data <span class="op">=</span> hfi_clean[[<span class="st">'group'</span>, <span class="st">'pf_score_square'</span>]].sort_values(by <span class="op">=</span> <span class="st">'pf_score_square'</span>)</span>
<span id="cb32-5"><a></a>data.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">group</th>
<th data-quarto-table-cell-role="th">pf_score_square</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">159</td>
<td>group1</td>
<td>4.693962</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">321</td>
<td>group1</td>
<td>5.461029</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">141</td>
<td>group1</td>
<td>6.308405</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">483</td>
<td>group1</td>
<td>6.345709</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">303</td>
<td>group1</td>
<td>8.189057</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="7f2c6277" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a></a>data.tail()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">group</th>
<th data-quarto-table-cell-role="th">pf_score_square</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">435</td>
<td>group2</td>
<td>90.755418</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1407</td>
<td>group2</td>
<td>91.284351</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">597</td>
<td>group2</td>
<td>91.396839</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1083</td>
<td>group2</td>
<td>91.428990</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">759</td>
<td>group2</td>
<td>91.549575</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="plot-the-grouped-data" class="slide level2">
<h2>Plot the grouped data</h2>
<div id="9865aa2d" class="cell" data-execution_count="35">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a></a>sns.histplot(data <span class="op">=</span> hfi_clean, x <span class="op">=</span> <span class="st">"pf_score_square"</span>, </span>
<span id="cb34-2"><a></a>            hue <span class="op">=</span> <span class="st">"group"</span>, kde <span class="op">=</span> <span class="va">True</span>, stat <span class="op">=</span> <span class="st">"density"</span>, common_norm <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb34-3"><a></a></span>
<span id="cb34-4"><a></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="04-preprocess_files/figure-revealjs/cell-36-output-1.png" width="831" height="439"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="dimensional-reduction" class="slide level2 smaller">
<h2>Dimensional reduction</h2>
<blockquote>
<p><strong>Dimension reduction</strong>, is the transformation of data from a high-dimensional space into a low-dimensional space so that the low-dimensional representation retains some meaningful properties of the original data, ideally close to its <a href="https://en.wikipedia.org/wiki/Intrinsic_dimension" title="Intrinsic dimension">intrinsic dimension</a>.</p>
</blockquote>
<div class="fragment">
<p><strong>Principal component analysis (PCA)</strong> - Unsupervised</p>
<ul>
<li class="fragment"><p>Maximizes variance in the dataset.</p></li>
<li class="fragment"><p>Finds orthogonal principal components.</p></li>
<li class="fragment"><p>Useful for feature extraction and data visualization.</p></li>
</ul>
</div>
<div class="fragment">
<p><strong>t-Distributed Stochastic Neighbor Embedding (t-SNE)</strong> - Unsupervised</p>
<ul>
<li class="fragment"><p>Preserves local structures and relationships</p></li>
<li class="fragment"><p>Maximizes the ratio of between-class variance to within-class variance.</p></li>
<li class="fragment"><p>Stochastic and iterative process (probabilistic), iteratively minimizing the divergence between distributions</p></li>
<li class="fragment"><p>Ideal for complex data visualization</p></li>
</ul>
</div>
</section>
<section id="dimensional-reduction-applied" class="slide level2 smaller">
<h2>Dimensional reduction: applied</h2>
<div class="panel-tabset">
<ul id="tabset-10" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-10-1">Prep</a></li><li><a href="#tabset-10-2">PCA: variance</a></li><li><a href="#tabset-10-3">PCA: scree plot</a></li><li><a href="#tabset-10-4">t-SNE: components</a></li><li><a href="#tabset-10-5">t-SNE: plot</a></li></ul>
<div class="tab-content">
<div id="tabset-10-1">
<div id="42f3db88" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a></a>numeric_cols <span class="op">=</span> hfi.select_dtypes(include <span class="op">=</span> [np.number]).columns</span>
<span id="cb35-2"><a></a></span>
<span id="cb35-3"><a></a><span class="co"># Applying mean imputation only to numeric columns</span></span>
<span id="cb35-4"><a></a>hfi[numeric_cols] <span class="op">=</span> hfi[numeric_cols].fillna(hfi[numeric_cols].mean())</span>
<span id="cb35-5"><a></a></span>
<span id="cb35-6"><a></a>features <span class="op">=</span> [<span class="st">'pf_rol_procedural'</span>, <span class="st">'pf_rol_civil'</span>, <span class="st">'pf_rol_criminal'</span>, <span class="st">'pf_rol'</span>, <span class="st">'hf_score'</span>, <span class="st">'hf_rank'</span>, <span class="st">'hf_quartile'</span>]</span>
<span id="cb35-7"><a></a></span>
<span id="cb35-8"><a></a>x <span class="op">=</span> hfi.loc[:, features].values</span>
<span id="cb35-9"><a></a>y <span class="op">=</span> hfi.loc[:, <span class="st">'region'</span>].values</span>
<span id="cb35-10"><a></a>x <span class="op">=</span> StandardScaler().fit_transform(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-10-2">
<div id="077a753f" class="cell" data-execution_count="37">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36" data-code-line-numbers="1-5|1|2|3|4|5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a></a>pca <span class="op">=</span> PCA(n_components <span class="op">=</span> <span class="dv">2</span>)</span>
<span id="cb36-2"><a></a>principalComponents <span class="op">=</span> pca.fit_transform(x)</span>
<span id="cb36-3"><a></a>principalDf <span class="op">=</span> pd.DataFrame(data <span class="op">=</span> principalComponents, columns <span class="op">=</span> [<span class="st">'principal component 1'</span>, <span class="st">'principal component 2'</span>])</span>
<span id="cb36-4"><a></a>pca_variance_explained <span class="op">=</span> pca.explained_variance_ratio_</span>
<span id="cb36-5"><a></a><span class="bu">print</span>(<span class="st">"Variance explained:"</span>, pca_variance_explained, <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>, principalDf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Variance explained: [0.76138995 0.15849799] 
       principal component 1  principal component 2
0              5.164625e-01          -9.665680e-01
1             -2.366765e+00           1.957381e+00
2             -2.147729e+00           1.664483e+00
3             -2.784437e-01           8.066415e-01
4              3.716205e-01          -4.294282e-01
...                     ...                    ...
1453          -4.181375e+00          -4.496988e-01
1454          -5.213024e-01           6.010449e-01
1455           1.374342e-16          -2.907121e-16
1456          -1.545577e+00          -5.422255e-01
1457          -3.669011e+00           4.294948e-01

[1458 rows x 2 columns]</code></pre>
</div>
</div>
</div>
<div id="tabset-10-3">
<div id="a4db6a6d" class="cell" data-execution_count="38">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a></a><span class="co"># Combining the scatterplot of principal components with the scree plot using the correct column names</span></span>
<span id="cb38-2"><a></a>fig, axes <span class="op">=</span> plt.subplots(nrows <span class="op">=</span> <span class="dv">1</span>, ncols <span class="op">=</span> <span class="dv">2</span>, figsize <span class="op">=</span> (<span class="dv">12</span>, <span class="dv">5</span>))</span>
<span id="cb38-3"><a></a></span>
<span id="cb38-4"><a></a><span class="co"># Scatterplot of Principal Components</span></span>
<span id="cb38-5"><a></a>axes[<span class="dv">0</span>].scatter(principalDf[<span class="st">'principal component 1'</span>], principalDf[<span class="st">'principal component 2'</span>])</span>
<span id="cb38-6"><a></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(pca.components_)):</span>
<span id="cb38-7"><a></a>    axes[<span class="dv">0</span>].arrow(<span class="dv">0</span>, <span class="dv">0</span>, pca.components_[i, <span class="dv">0</span>], pca.components_[i, <span class="dv">1</span>], head_width <span class="op">=</span> <span class="fl">0.1</span>, head_length <span class="op">=</span> <span class="fl">0.15</span>, fc <span class="op">=</span> <span class="st">'r'</span>, ec <span class="op">=</span> <span class="st">'r'</span>, linewidth <span class="op">=</span> <span class="dv">2</span>)</span>
<span id="cb38-8"><a></a>    axes[<span class="dv">0</span>].text(pca.components_[i, <span class="dv">0</span>] <span class="op">*</span> <span class="fl">1.2</span>, pca.components_[i, <span class="dv">1</span>] <span class="op">*</span> <span class="fl">1.2</span>, <span class="ss">f'Eigenvector </span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">'</span>, color <span class="op">=</span> <span class="st">'r'</span>, fontsize <span class="op">=</span> <span class="dv">12</span>)</span>
<span id="cb38-9"><a></a>axes[<span class="dv">0</span>].set_xlabel(<span class="st">'Principal Component 1'</span>)</span>
<span id="cb38-10"><a></a>axes[<span class="dv">0</span>].set_ylabel(<span class="st">'Principal Component 2'</span>)</span>
<span id="cb38-11"><a></a>axes[<span class="dv">0</span>].set_title(<span class="st">'Scatterplot of Principal Components with Eigenvectors'</span>)</span>
<span id="cb38-12"><a></a>axes[<span class="dv">0</span>].grid()</span>
<span id="cb38-13"><a></a></span>
<span id="cb38-14"><a></a><span class="co"># Scree Plot for PCA</span></span>
<span id="cb38-15"><a></a>axes[<span class="dv">1</span>].bar(<span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(pca_variance_explained) <span class="op">+</span> <span class="dv">1</span>), pca_variance_explained, alpha <span class="op">=</span> <span class="fl">0.6</span>, color <span class="op">=</span> <span class="st">'g'</span>, label <span class="op">=</span> <span class="st">'Individual Explained Variance'</span>)</span>
<span id="cb38-16"><a></a>axes[<span class="dv">1</span>].set_ylabel(<span class="st">'Explained variance ratio'</span>)</span>
<span id="cb38-17"><a></a>axes[<span class="dv">1</span>].set_xlabel(<span class="st">'Principal components'</span>)</span>
<span id="cb38-18"><a></a>axes[<span class="dv">1</span>].set_title(<span class="st">'Scree Plot for PCA'</span>)</span>
<span id="cb38-19"><a></a>axes[<span class="dv">1</span>].legend(loc<span class="op">=</span><span class="st">'best'</span>)</span>
<span id="cb38-20"><a></a></span>
<span id="cb38-21"><a></a>plt.tight_layout()</span>
<span id="cb38-22"><a></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="04-preprocess_files/figure-revealjs/cell-39-output-1.png" width="1129" height="455"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-10-4">
<div id="90580e06" class="cell" data-execution_count="39">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39" data-code-line-numbers="1-5|1|2|4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a></a>tsne <span class="op">=</span> TSNE(n_components <span class="op">=</span> <span class="dv">2</span>, random_state <span class="op">=</span> <span class="dv">42</span>)</span>
<span id="cb39-2"><a></a>tsne_results <span class="op">=</span> tsne.fit_transform(x)</span>
<span id="cb39-3"><a></a></span>
<span id="cb39-4"><a></a>tsne_df <span class="op">=</span> pd.DataFrame(data <span class="op">=</span> tsne_results, columns <span class="op">=</span> [<span class="st">'tsne-2d-one'</span>, <span class="st">'tsne-2d-two'</span>])</span>
<span id="cb39-5"><a></a>tsne_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="35">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">tsne-2d-one</th>
<th data-quarto-table-cell-role="th">tsne-2d-two</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>8.723544</td>
<td>-30.771170</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>-28.243269</td>
<td>35.372395</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>-34.433094</td>
<td>34.752293</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>-6.945469</td>
<td>15.958995</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>6.562296</td>
<td>-19.255369</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1453</td>
<td>-55.390907</td>
<td>-8.568928</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1454</td>
<td>-12.814189</td>
<td>12.753754</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1455</td>
<td>11.118634</td>
<td>7.232168</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1456</td>
<td>-19.679014</td>
<td>-8.271861</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1457</td>
<td>-54.577549</td>
<td>-2.688204</td>
</tr>
</tbody>
</table>

<p>1458 rows × 2 columns</p>
</div>
</div>
</div>
</div>
<div id="tabset-10-5">
<div id="beeeb4d1" class="cell" data-execution_count="40">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a></a>tsne_df[<span class="st">'region'</span>] <span class="op">=</span> y</span>
<span id="cb40-2"><a></a></span>
<span id="cb40-3"><a></a>plt.figure(figsize <span class="op">=</span> (<span class="dv">7</span>, <span class="dv">5</span>))</span>
<span id="cb40-4"><a></a>plt.scatter(tsne_df[<span class="st">'tsne-2d-one'</span>], tsne_df[<span class="st">'tsne-2d-two'</span>], c <span class="op">=</span> pd.factorize(tsne_df[<span class="st">'region'</span>])[<span class="dv">0</span>], alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb40-5"><a></a>plt.colorbar(ticks <span class="op">=</span> <span class="bu">range</span>(<span class="bu">len</span>(np.unique(y))))</span>
<span id="cb40-6"><a></a>plt.xlabel(<span class="st">'TSNE Dimension 1'</span>)</span>
<span id="cb40-7"><a></a>plt.ylabel(<span class="st">'TSNE Dimension 2'</span>)</span>
<span id="cb40-8"><a></a>plt.title(<span class="st">'t-SNE Results with Region Color Coding'</span>)</span>
<span id="cb40-9"><a></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="04-preprocess_files/figure-revealjs/cell-41-output-1.png" width="564" height="460"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="dimensional-reduction-what-now" class="slide level2 smaller">
<h2>Dimensional reduction: what now?</h2>
<ol type="1">
<li class="fragment"><p><strong>Feature Selection:</strong> Choose the most informative components.</p></li>
<li class="fragment"><p><strong>Visualization:</strong> Graph the reduced dimensions to identify patterns.</p></li>
<li class="fragment"><p><strong>Clustering:</strong> Group similar data points using clustering algorithms.</p></li>
<li class="fragment"><p><strong>Classification:</strong> Predict categories using classifiers on reduced features.</p></li>
<li class="fragment"><p><strong>Model Evaluation:</strong> Assess model performance with metrics like accuracy.</p></li>
<li class="fragment"><p><strong>Cross-Validation:</strong> Validate model stability with cross-validation.</p></li>
<li class="fragment"><p><strong>Hyperparameter Tuning:</strong> Optimize model settings for better performance.</p></li>
<li class="fragment"><p><strong>Model Interpretation:</strong> Understand feature influence in the models.</p></li>
<li class="fragment"><p><strong>Ensemble Methods:</strong> Improve predictions by combining multiple models.</p></li>
<li class="fragment"><p><strong>Deployment:</strong> Deploy the model for real-world predictions.</p></li>
<li class="fragment"><p><strong>Iterative Refinement:</strong> Refine analysis based on initial results.</p></li>
<li class="fragment"><p><strong>Reporting:</strong> Summarize findings for stakeholders.</p></li>
</ol>
</section></section>
<section>
<section id="back-to-our-question" class="title-slide slide level1 center">
<h1>Back to our question</h1>

</section>
<section id="question-1" class="slide level2">
<h2>Question</h2>
<p>How does <strong>environmental stability</strong> <u>correlate</u> with <strong>human freedom indices</strong> in <u>different countries</u>, and what <u>trends</u> can be observed over <u>recent years</u>?</p>
<div class="fragment">
<ul>
<li class="fragment"><p>We can use the <strong><code>pf_score</code></strong> from the <code>hfi</code> dataset that we’ve been using.</p></li>
<li class="fragment"><p>…but we need an environmental stability index score.</p></li>
</ul>
</div>
</section>
<section id="dataset-2-environmental-stability" class="slide level2 smaller">
<h2>Dataset #2: Environmental Stability</h2>
<div id="0130e5bf" class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a></a>esi <span class="op">=</span> pd.read_csv(<span class="st">"data/esi.csv"</span>)</span>
<span id="cb41-2"><a></a>esi.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="37">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">code</th>
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th">esi</th>
<th data-quarto-table-cell-role="th">system</th>
<th data-quarto-table-cell-role="th">stress</th>
<th data-quarto-table-cell-role="th">vulner</th>
<th data-quarto-table-cell-role="th">cap</th>
<th data-quarto-table-cell-role="th">global</th>
<th data-quarto-table-cell-role="th">sys_air</th>
<th data-quarto-table-cell-role="th">sys_bio</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">vul_hea</th>
<th data-quarto-table-cell-role="th">vul_sus</th>
<th data-quarto-table-cell-role="th">vul_dis</th>
<th data-quarto-table-cell-role="th">cap_gov</th>
<th data-quarto-table-cell-role="th">cap_eff</th>
<th data-quarto-table-cell-role="th">cap_pri</th>
<th data-quarto-table-cell-role="th">cap_st</th>
<th data-quarto-table-cell-role="th">glo_col</th>
<th data-quarto-table-cell-role="th">glo_ghg</th>
<th data-quarto-table-cell-role="th">glo_tbp</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>ALB</td>
<td>Albania</td>
<td>58.8</td>
<td>52.4</td>
<td>65.4</td>
<td>72.3</td>
<td>46.2</td>
<td>57.9</td>
<td>0.45</td>
<td>0.17</td>
<td>...</td>
<td>0.32</td>
<td>0.79</td>
<td>0.66</td>
<td>-0.32</td>
<td>0.79</td>
<td>-0.65</td>
<td>-0.20</td>
<td>-0.45</td>
<td>0.21</td>
<td>0.84</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>DZA</td>
<td>Algeria</td>
<td>46.0</td>
<td>43.1</td>
<td>66.3</td>
<td>57.5</td>
<td>31.8</td>
<td>21.1</td>
<td>-0.02</td>
<td>-0.08</td>
<td>...</td>
<td>-0.33</td>
<td>0.45</td>
<td>0.45</td>
<td>-0.69</td>
<td>-0.28</td>
<td>-0.66</td>
<td>-0.27</td>
<td>-0.51</td>
<td>-0.56</td>
<td>-1.33</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>AGO</td>
<td>Angola</td>
<td>42.9</td>
<td>67.9</td>
<td>59.1</td>
<td>11.8</td>
<td>22.1</td>
<td>39.1</td>
<td>-0.77</td>
<td>0.77</td>
<td>...</td>
<td>-1.75</td>
<td>-1.91</td>
<td>0.11</td>
<td>-0.96</td>
<td>0.12</td>
<td>-1.08</td>
<td>-1.16</td>
<td>-0.88</td>
<td>0.31</td>
<td>-0.26</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>ARG</td>
<td>Argentina</td>
<td>62.7</td>
<td>67.6</td>
<td>54.9</td>
<td>69.9</td>
<td>65.4</td>
<td>58.5</td>
<td>0.40</td>
<td>0.10</td>
<td>...</td>
<td>0.85</td>
<td>0.69</td>
<td>0.03</td>
<td>-0.34</td>
<td>0.18</td>
<td>1.23</td>
<td>0.51</td>
<td>0.45</td>
<td>0.09</td>
<td>0.11</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>ARM</td>
<td>Armenia</td>
<td>53.2</td>
<td>54.4</td>
<td>62.2</td>
<td>50.8</td>
<td>34.9</td>
<td>60.3</td>
<td>1.21</td>
<td>-0.02</td>
<td>...</td>
<td>0.29</td>
<td>-0.79</td>
<td>0.56</td>
<td>-0.38</td>
<td>-0.66</td>
<td>-0.55</td>
<td>0.03</td>
<td>-0.29</td>
<td>-0.29</td>
<td>1.37</td>
</tr>
</tbody>
</table>

<p>5 rows × 29 columns</p>
</div>
</div>
</div>
<div class="fragment">
<ul>
<li class="fragment"><p>Looks like the <code>esi</code> column will work!</p></li>
<li class="fragment"><p>But there’s a problem…</p></li>
<li class="fragment"><p>We only have one year in this dataset</p></li>
<li class="fragment"><p>P.S. there’s no missing values</p></li>
</ul>
</div>
</section>
<section id="grouping-and-aggregating" class="slide level2 smaller">
<h2>Grouping and aggregating</h2>
<div id="582eab6d" class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb42" data-code-line-numbers="1-4|1-2|3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a></a>grouped_hfi <span class="op">=</span> hfi.groupby(<span class="st">'countries'</span>).agg({<span class="st">'region'</span>: <span class="st">'first'</span>, </span>
<span id="cb42-2"><a></a>                                            <span class="st">'pf_score'</span>: <span class="st">'mean'</span></span>
<span id="cb42-3"><a></a>                                           }).reset_index()</span>
<span id="cb42-4"><a></a>grouped_hfi.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="38">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">countries</th>
<th data-quarto-table-cell-role="th">region</th>
<th data-quarto-table-cell-role="th">pf_score</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Albania</td>
<td>Eastern Europe</td>
<td>7.696934</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Algeria</td>
<td>Middle East &amp; North Africa</td>
<td>5.249383</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Angola</td>
<td>Sub-Saharan Africa</td>
<td>5.856932</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Argentina</td>
<td>Latin America &amp; the Caribbean</td>
<td>8.120779</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Armenia</td>
<td>Caucasus &amp; Central Asia</td>
<td>7.192095</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="joining-the-data" class="slide level2 smaller">
<h2>Joining the data</h2>
<div id="356a1064" class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb43" data-code-line-numbers="1-5|1-2|4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a></a>grouped_hfi[<span class="st">'country'</span>] <span class="op">=</span> grouped_hfi[<span class="st">'countries'</span>]</span>
<span id="cb43-2"><a></a>merged_data <span class="op">=</span> esi.merge(grouped_hfi, how <span class="op">=</span> <span class="st">'left'</span>, on <span class="op">=</span> <span class="st">'country'</span>)</span>
<span id="cb43-3"><a></a></span>
<span id="cb43-4"><a></a>esi_hfi <span class="op">=</span> merged_data[[<span class="st">'esi'</span>, <span class="st">'pf_score'</span>, <span class="st">'region'</span>, <span class="st">'country'</span>]]</span>
<span id="cb43-5"><a></a>esi_hfi.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="39">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">esi</th>
<th data-quarto-table-cell-role="th">pf_score</th>
<th data-quarto-table-cell-role="th">region</th>
<th data-quarto-table-cell-role="th">country</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>58.8</td>
<td>7.696934</td>
<td>Eastern Europe</td>
<td>Albania</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>46.0</td>
<td>5.249383</td>
<td>Middle East &amp; North Africa</td>
<td>Algeria</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>42.9</td>
<td>5.856932</td>
<td>Sub-Saharan Africa</td>
<td>Angola</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>62.7</td>
<td>8.120779</td>
<td>Latin America &amp; the Caribbean</td>
<td>Argentina</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>53.2</td>
<td>7.192095</td>
<td>Caucasus &amp; Central Asia</td>
<td>Armenia</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<ul>
<li class="fragment"><p>…but what’s the new problem?</p></li>
<li class="fragment"><p>We need to <strong>standardize</strong> the data.</p></li>
<li class="fragment"><p>Lucky for us this will also help control outliers!</p></li>
</ul>
</section>
<section id="back-to-missing-values" class="slide level2">
<h2>Back to missing values</h2>
<p>We are going to drop them, since they are also present in <code>region</code></p>
<div id="46fa44b9" class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a></a>esi_hfi_red <span class="op">=</span> esi_hfi.dropna()</span>
<span id="cb44-2"><a></a>esi_hfi_red.isna().<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="40">
<pre><code>esi         0
pf_score    0
region      0
country     0
dtype: int64</code></pre>
</div>
</div>
</section></section>
<section>
<section id="transformations-1" class="title-slide slide level1 center">
<h1>Transformations</h1>

</section>
<section id="normality-test-q-q-plot-1" class="slide level2 smaller">
<h2>Normality test: Q-Q plot</h2>
<div class="panel-tabset">
<ul id="tabset-11" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-11-1"><code>pf_score</code></a></li><li><a href="#tabset-11-2"><code>esi</code></a></li></ul>
<div class="tab-content">
<div id="tabset-11-1">
<div id="a0d337b5" class="cell" data-execution_count="45">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a></a>sns.set_style(<span class="st">"white"</span>)</span>
<span id="cb46-2"><a></a>fig, (ax1, ax2) <span class="op">=</span> plt.subplots(ncols <span class="op">=</span> <span class="dv">2</span>, nrows <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb46-3"><a></a></span>
<span id="cb46-4"><a></a>sns.kdeplot(data <span class="op">=</span> esi_hfi_red, x <span class="op">=</span> <span class="st">"pf_score"</span>, linewidth <span class="op">=</span> <span class="dv">5</span>, ax <span class="op">=</span> ax1)</span>
<span id="cb46-5"><a></a>ax1.set_title(<span class="st">'Personal Freedom Score'</span>)</span>
<span id="cb46-6"><a></a></span>
<span id="cb46-7"><a></a>sm.qqplot(esi_hfi_red[<span class="st">'pf_score'</span>], line <span class="op">=</span> <span class="st">'s'</span>, ax <span class="op">=</span> ax2, dist <span class="op">=</span> stats.norm, fit <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb46-8"><a></a>ax2.set_title(<span class="st">'Personal Freedom Score Q-Q plot'</span>)</span>
<span id="cb46-9"><a></a></span>
<span id="cb46-10"><a></a>plt.tight_layout()</span>
<span id="cb46-11"><a></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="04-preprocess_files/figure-revealjs/cell-46-output-1.png" width="937" height="454"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-11-2">
<div id="5d772789" class="cell" data-execution_count="46">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a></a>fig, (ax1, ax2) <span class="op">=</span> plt.subplots(ncols <span class="op">=</span> <span class="dv">2</span>, nrows <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb47-2"><a></a></span>
<span id="cb47-3"><a></a>sns.kdeplot(data <span class="op">=</span> esi_hfi_red, x <span class="op">=</span> <span class="st">"esi"</span>, linewidth <span class="op">=</span> <span class="dv">5</span>, ax <span class="op">=</span> ax1)</span>
<span id="cb47-4"><a></a>ax1.set_title(<span class="st">'Environmental Stability Score'</span>)</span>
<span id="cb47-5"><a></a></span>
<span id="cb47-6"><a></a>sm.qqplot(esi_hfi_red[<span class="st">'esi'</span>], line <span class="op">=</span> <span class="st">'s'</span>, ax <span class="op">=</span> ax2, dist <span class="op">=</span> stats.norm, fit <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb47-7"><a></a>ax2.set_title(<span class="st">'Environmental Stability Score Q-Q plot'</span>)</span>
<span id="cb47-8"><a></a></span>
<span id="cb47-9"><a></a>plt.tight_layout()</span>
<span id="cb47-10"><a></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="04-preprocess_files/figure-revealjs/cell-47-output-1.png" width="937" height="455"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="correcting-skew-1" class="slide level2 smaller">
<h2>Correcting skew</h2>
<div class="panel-tabset">
<ul id="tabset-12" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-12-1"><code>pf_score</code></a></li><li><a href="#tabset-12-2"><code>esi</code></a></li></ul>
<div class="tab-content">
<div id="tabset-12-1">
<div id="bf10ecb4" class="cell" data-execution_count="47">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a></a>esi_hfi_red[<span class="st">'pf_score_square'</span>] <span class="op">=</span> <span class="bu">pow</span>(esi_hfi_red.pf_score, <span class="dv">2</span>)</span>
<span id="cb48-2"><a></a></span>
<span id="cb48-3"><a></a>col <span class="op">=</span> esi_hfi_red[<span class="st">'pf_score_square'</span>]</span>
<span id="cb48-4"><a></a></span>
<span id="cb48-5"><a></a>fig, (ax1, ax2) <span class="op">=</span> plt.subplots(ncols <span class="op">=</span> <span class="dv">2</span>, nrows <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb48-6"><a></a></span>
<span id="cb48-7"><a></a>sns.kdeplot(col, linewidth <span class="op">=</span> <span class="dv">5</span>, ax <span class="op">=</span> ax1)</span>
<span id="cb48-8"><a></a>ax1.set_title(<span class="st">'Squared Density plot'</span>)    </span>
<span id="cb48-9"><a></a></span>
<span id="cb48-10"><a></a>sm.qqplot(col, line <span class="op">=</span> <span class="st">'s'</span>, ax <span class="op">=</span> ax2)</span>
<span id="cb48-11"><a></a>ax2.set_title(<span class="st">'Squared Q-Q plot'</span>)    </span>
<span id="cb48-12"><a></a>plt.tight_layout()</span>
<span id="cb48-13"><a></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="04-preprocess_files/figure-revealjs/cell-48-output-1.png" width="937" height="454"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-12-2">
<div id="229cc25d" class="cell" data-execution_count="48">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a></a>esi_hfi_red[<span class="st">'esi_log'</span>] <span class="op">=</span> np.log(esi_hfi_red.esi <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb49-2"><a></a></span>
<span id="cb49-3"><a></a>col <span class="op">=</span> esi_hfi_red[<span class="st">'esi_log'</span>]</span>
<span id="cb49-4"><a></a></span>
<span id="cb49-5"><a></a>fig, (ax1, ax2) <span class="op">=</span> plt.subplots(ncols <span class="op">=</span> <span class="dv">2</span>, nrows <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb49-6"><a></a></span>
<span id="cb49-7"><a></a>sns.kdeplot(col, linewidth <span class="op">=</span> <span class="dv">5</span>, ax <span class="op">=</span> ax1)</span>
<span id="cb49-8"><a></a>ax1.set_title(<span class="st">'Log Density plot'</span>)    </span>
<span id="cb49-9"><a></a></span>
<span id="cb49-10"><a></a>sm.qqplot(col, line <span class="op">=</span> <span class="st">'s'</span>, ax <span class="op">=</span> ax2)</span>
<span id="cb49-11"><a></a>ax2.set_title(<span class="st">'Log Q-Q plot'</span>)    </span>
<span id="cb49-12"><a></a>plt.tight_layout()</span>
<span id="cb49-13"><a></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="04-preprocess_files/figure-revealjs/cell-49-output-1.png" width="937" height="454"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="normalizing-1" class="slide level2 smaller">
<h2>Normalizing</h2>
<div id="7ec19705" class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a></a>scaler <span class="op">=</span> StandardScaler()</span>
<span id="cb50-2"><a></a>esi_hfi_red[[<span class="st">'esi_log'</span>, <span class="st">'pf_score_square'</span>]] <span class="op">=</span> scaler.fit_transform(esi_hfi_red[[<span class="st">'esi_log'</span>, <span class="st">'pf_score_square'</span>]])</span>
<span id="cb50-3"><a></a></span>
<span id="cb50-4"><a></a>esi_hfi_red.describe().<span class="bu">round</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="45">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">esi</th>
<th data-quarto-table-cell-role="th">pf_score</th>
<th data-quarto-table-cell-role="th">pf_score_square</th>
<th data-quarto-table-cell-role="th">esi_log</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>129.000</td>
<td>129.000</td>
<td>129.000</td>
<td>129.000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>50.599</td>
<td>7.210</td>
<td>0.000</td>
<td>0.000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>8.304</td>
<td>1.291</td>
<td>1.004</td>
<td>1.004</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">min</td>
<td>32.700</td>
<td>4.203</td>
<td>-1.916</td>
<td>-2.604</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25%</td>
<td>44.800</td>
<td>6.207</td>
<td>-0.805</td>
<td>-0.671</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50%</td>
<td>50.000</td>
<td>7.074</td>
<td>-0.191</td>
<td>0.006</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75%</td>
<td>56.100</td>
<td>8.415</td>
<td>0.915</td>
<td>0.718</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>75.100</td>
<td>9.476</td>
<td>1.927</td>
<td>2.527</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="correlations" class="slide level2 smaller">
<h2>Correlations</h2>
<div class="panel-tabset">
<ul id="tabset-13" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-13-1">Correlation</a></li><li><a href="#tabset-13-2">Plot</a></li></ul>
<div class="tab-content">
<div id="tabset-13-1">
<div id="98fbccd9" class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a></a>esi_hfi_num <span class="op">=</span> esi_hfi_red.select_dtypes(include <span class="op">=</span> <span class="st">'number'</span>)</span>
<span id="cb51-2"><a></a></span>
<span id="cb51-3"><a></a>corr <span class="op">=</span> esi_hfi_num.corr()</span>
<span id="cb51-4"><a></a>corr</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="46">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">esi</th>
<th data-quarto-table-cell-role="th">pf_score</th>
<th data-quarto-table-cell-role="th">pf_score_square</th>
<th data-quarto-table-cell-role="th">esi_log</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">esi</td>
<td>1.000000</td>
<td>0.574756</td>
<td>0.583615</td>
<td>0.993689</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">pf_score</td>
<td>0.574756</td>
<td>1.000000</td>
<td>0.995631</td>
<td>0.560831</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">pf_score_square</td>
<td>0.583615</td>
<td>0.995631</td>
<td>1.000000</td>
<td>0.566744</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">esi_log</td>
<td>0.993689</td>
<td>0.560831</td>
<td>0.566744</td>
<td>1.000000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<div id="tabset-13-2">
<div id="4dcc4b71" class="cell" data-execution_count="51">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a></a>plt.figure(figsize <span class="op">=</span> (<span class="dv">7</span>, <span class="dv">5</span>))</span>
<span id="cb52-2"><a></a>ax <span class="op">=</span> sns.scatterplot(data <span class="op">=</span> esi_hfi_red, x <span class="op">=</span> <span class="st">"pf_score_square"</span>, y <span class="op">=</span> <span class="st">"esi_log"</span>,</span>
<span id="cb52-3"><a></a>                hue <span class="op">=</span> <span class="st">"region"</span>, palette <span class="op">=</span> <span class="st">"colorblind"</span>)</span>
<span id="cb52-4"><a></a>ax.legend(title <span class="op">=</span> <span class="st">"Region"</span>,</span>
<span id="cb52-5"><a></a>          bbox_to_anchor <span class="op">=</span> (<span class="fl">1.02</span>, <span class="dv">1</span>), loc <span class="op">=</span> <span class="st">'upper left'</span>, borderaxespad <span class="op">=</span> <span class="dv">0</span>)</span>
<span id="cb52-6"><a></a>ax.<span class="bu">set</span>(xlabel <span class="op">=</span> <span class="st">"Personal Freedom Log-Normal "</span>)</span>
<span id="cb52-7"><a></a>ax.<span class="bu">set</span>(ylabel <span class="op">=</span> <span class="st">"Environmental Stability Squared-Normal"</span>)</span>
<span id="cb52-8"><a></a>ax.<span class="bu">set</span>(title <span class="op">=</span> <span class="st">"Human Freedom Index vs. Environmental Stability"</span>)</span>
<span id="cb52-9"><a></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="04-preprocess_files/figure-revealjs/cell-52-output-1.png" width="906" height="460"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="correlations-p-value" class="slide level2 smaller">
<h2>Correlations: p-value</h2>
<div class="panel-tabset">
<ul id="tabset-14" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-14-1">p-value</a></li><li><a href="#tabset-14-2">Trend line</a></li></ul>
<div class="tab-content">
<div id="tabset-14-1">
<div id="a67740e8" class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a></a>x <span class="op">=</span> esi_hfi_red[<span class="st">'pf_score_square'</span>]</span>
<span id="cb53-2"><a></a>y <span class="op">=</span> esi_hfi_red[<span class="st">'esi_log'</span>]</span>
<span id="cb53-3"><a></a>corr_coefficient, p_value <span class="op">=</span> pearsonr(x, y)</span>
<span id="cb53-4"><a></a></span>
<span id="cb53-5"><a></a><span class="bu">print</span>(<span class="st">"Pearson correlation coefficient:"</span>, corr_coefficient.<span class="bu">round</span>(<span class="dv">3</span>))</span>
<span id="cb53-6"><a></a><span class="bu">print</span>(<span class="st">"P-value:"</span>, p_value.<span class="bu">round</span>(<span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Pearson correlation coefficient: 0.567
P-value: 0.0</code></pre>
</div>
</div>
</div>
<div id="tabset-14-2">
<div id="cc3941e5" class="cell" data-execution_count="53">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a></a>sns.lmplot(data <span class="op">=</span> esi_hfi_red, x <span class="op">=</span> <span class="st">"pf_score_square"</span>, y <span class="op">=</span> <span class="st">"esi_log"</span>, height <span class="op">=</span> <span class="dv">5</span>, aspect <span class="op">=</span> <span class="dv">7</span><span class="op">/</span><span class="dv">5</span>)</span>
<span id="cb55-2"><a></a></span>
<span id="cb55-3"><a></a>plt.xlabel(<span class="st">"Personal Freedom Log-Normal"</span>)</span>
<span id="cb55-4"><a></a>plt.ylabel(<span class="st">"Environmental Stability Squared-Normal"</span>)</span>
<span id="cb55-5"><a></a>plt.title(<span class="st">"Human Freedom Index vs. Environmental Stability"</span>)</span>
<span id="cb55-6"><a></a></span>
<span id="cb55-7"><a></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="04-preprocess_files/figure-revealjs/cell-54-output-1.png" width="648" height="476"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="conclusions-question" class="slide level2">
<h2>Conclusions: question</h2>
<p>How does <strong>environmental stability</strong> <u>correlate</u> with <strong>human freedom indices</strong> in <u>different countries</u>, and what <u>trends</u> can be observed over <u>recent years</u>?</p>
<ol type="1">
<li class="fragment">We can’t make inferences about <u>recent years</u>…</li>
<li class="fragment"><strong>Moderate positive correlation</strong> between <strong>human freedom index</strong> and <strong>environmental stability</strong></li>
<li class="fragment">We cannot find a relationship between countries either</li>
<li class="fragment">We need a <strong>linear regression</strong> next (<u>later</u>)</li>
</ol>
</section>
<section id="conclusions-data-preprocessing" class="slide level2">
<h2>Conclusions: data preprocessing</h2>
<p><strong>There are multiple steps:</strong></p>
<ol type="1">
<li class="fragment"><p>Check the <strong>distribution</strong> for <strong>normality</strong></p></li>
<li class="fragment"><p>Likely will need a <strong>transformation</strong> based on the <strong>severity</strong> and <strong>direction of skew</strong></p></li>
<li class="fragment"><p><strong>Normalize</strong> the data with different units</p></li>
<li class="fragment"><p><strong>Correlations</strong> are a good start, but <strong>regressions</strong> are more definitive</p></li>
<li class="fragment"><p>It’s “as needed”, ergo we didn’t cover everything…</p></li>
</ol>


</section></section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<p><img src="../logo.png" class="slide-logo"></p>
<div class="footer footer-default">
<p><a href="https://datamineaz.org/">🔗 datamineaz.org</a></p>
</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="../../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"8\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'fade',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
            const codeEl = trigger.previousElementSibling.cloneNode(true);
            for (const childEl of codeEl.children) {
              if (isCodeAnnotation(childEl)) {
                childEl.remove();
              }
            }
            return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp('/' + window.location.host + '/');
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    

</body></html>