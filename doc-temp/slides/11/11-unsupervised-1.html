<!DOCTYPE html>
<html lang="en"><head>
<link href="../../..//images/logo.png" rel="icon" type="image/png">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-html/tabby.min.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-ea385d0e468b0dd5ea5bf0780b1290d9.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.7.33">

  <meta name="author" content="John Chen">
  <title>INFO 523 – Unsupervised Learning I</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../../../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../../../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../../../site_libs/revealjs/dist/theme/quarto-191024931916078fc4eae1dde1f53f1c.css">
  <link href="../../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../../../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../../../site_libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="../../../site_libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="../../../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
  
  <script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<meta property="og:title" content="UnsupervisedLearning I – INFO 523">
<meta property="og:description" content="Lecture 11">
<meta property="og:site_name" content="INFO 523">
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-image="../minedata-bg.png" data-background-size="600px, cover" data-slide-number="none" class="quarto-title-block center">
  <h1 class="title">Unsupervised<br>Learning I</h1>
  <p class="subtitle">Lecture 11</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
John Chen 
</div>
        <p class="quarto-title-affiliation">
            University of Arizona <br> INFO 523 - Fall 2025
          </p>
    </div>
</div>

</section>
<section>
<section id="warm-up" class="title-slide slide level1 center">
<h1>Warm up</h1>

</section>
<section id="announcements" class="slide level2">
<h2>Announcements</h2>
<ul>
<li>HW 05 is due Fri Apr 26, 11:59pm</li>
</ul>
</section>
<section id="setup" class="slide level2 smaller">
<h2>Setup</h2>
<div id="setup" class="cell" data-message="false" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a></a><span class="co"># Data Handling and Manipulation</span></span>
<span id="cb1-2"><a></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-4"><a></a></span>
<span id="cb1-5"><a></a><span class="co"># Data Preprocessing</span></span>
<span id="cb1-6"><a></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler, OneHotEncoder</span>
<span id="cb1-7"><a></a><span class="im">from</span> sklearn.compose <span class="im">import</span> ColumnTransformer</span>
<span id="cb1-8"><a></a><span class="im">from</span> sklearn.pipeline <span class="im">import</span> Pipeline</span>
<span id="cb1-9"><a></a><span class="im">from</span> sklearn.impute <span class="im">import</span> SimpleImputer</span>
<span id="cb1-10"><a></a><span class="im">from</span> sklearn.decomposition <span class="im">import</span> PCA</span>
<span id="cb1-11"><a></a></span>
<span id="cb1-12"><a></a><span class="co"># Model Selection and Evaluation</span></span>
<span id="cb1-13"><a></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split, GridSearchCV, RandomizedSearchCV</span>
<span id="cb1-14"><a></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> silhouette_score, davies_bouldin_score, calinski_harabasz_score</span>
<span id="cb1-15"><a></a><span class="im">from</span> sklearn.mixture <span class="im">import</span> GaussianMixture</span>
<span id="cb1-16"><a></a></span>
<span id="cb1-17"><a></a><span class="co"># Machine Learning Models</span></span>
<span id="cb1-18"><a></a><span class="im">from</span> sklearn.cluster <span class="im">import</span> KMeans</span>
<span id="cb1-19"><a></a><span class="im">from</span> sklearn_extra.cluster <span class="im">import</span> KMedoids</span>
<span id="cb1-20"><a></a></span>
<span id="cb1-21"><a></a><span class="co"># Data Visualization</span></span>
<span id="cb1-22"><a></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-23"><a></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-24"><a></a></span>
<span id="cb1-25"><a></a><span class="co"># Set the default style for visualization</span></span>
<span id="cb1-26"><a></a>sns.set_theme(style <span class="op">=</span> <span class="st">"white"</span>, palette <span class="op">=</span> <span class="st">"colorblind"</span>)</span>
<span id="cb1-27"><a></a></span>
<span id="cb1-28"><a></a><span class="co"># Increase font size of all Seaborn plot elements</span></span>
<span id="cb1-29"><a></a>sns.<span class="bu">set</span>(font_scale <span class="op">=</span> <span class="fl">1.25</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section>
<section>
<section id="unsupervised-learning" class="title-slide slide level1 center">
<h1>Unsupervised Learning</h1>

</section>
<section id="section" class="slide level2">
<h2></h2>
<p><br></p>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/unsupervised.jpeg" width="1528"></p>
<figcaption>Credit: <a href="https://recro.io/blog/supervised-vs-unsupervised-learning-key-differences/">Recro</a></figcaption>
</figure>
</div>
</section>
<section id="clustering" class="slide level2">
<h2>Clustering</h2>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/clustering-1.png" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
</section>
<section id="clustering-1" class="slide level2 smaller">
<h2>Clustering</h2>
<p>Some use cases for clustering include:</p>
<ul>
<li class="fragment"><p><a href="https://pages.dataiku.com/recommendation-engines"><strong>Recommender systems</strong></a>:</p>
<ul>
<li class="fragment">Grouping together users with similar viewing patterns on Netflix, in order to recommend similar content</li>
</ul></li>
<li class="fragment"><p><a href="https://pages.dataiku.com/anomaly-detection-at-scale-guidebook"><strong>Anomaly detection</strong></a>:</p>
<ul>
<li class="fragment">Fraud detection, detecting defective mechanical parts</li>
</ul></li>
<li class="fragment"><p><strong>Genetics</strong>:</p>
<ul>
<li class="fragment">Clustering DNA patterns to analyze evolutionary biology</li>
</ul></li>
<li class="fragment"><p><strong>Customer segmentation</strong>:</p>
<ul>
<li class="fragment">Understanding different customer segments to devise marketing strategies</li>
</ul></li>
</ul>
</section>
<section id="question" class="slide level2">
<h2>Question:</h2>
<p>Can we <u>identify distinct baseball player groupings</u> based on their <strong>player stats</strong> in 2018?</p>
</section>
<section id="our-data-mlb-player-stats" class="slide level2 smaller">
<h2>Our data: MLB player stats</h2>
<div class="panel-tabset">
<ul id="tabset-1" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-1-1">Read + Head</a></li><li><a href="#tabset-1-2">Metadata</a></li><li><a href="#tabset-1-3">Info</a></li><li><a href="#tabset-1-4">Categories</a></li><li><a href="#tabset-1-5">Describe</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1">
<div id="b0acc37c" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a></a>mlb_players_18 <span class="op">=</span> pd.read_csv(<span class="st">"data/mlb_players_18.csv"</span>, encoding <span class="op">=</span> <span class="st">'iso-8859-1'</span>)</span>
<span id="cb2-2"><a></a></span>
<span id="cb2-3"><a></a>mlb_players_18.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">team</th>
<th data-quarto-table-cell-role="th">position</th>
<th data-quarto-table-cell-role="th">games</th>
<th data-quarto-table-cell-role="th">AB</th>
<th data-quarto-table-cell-role="th">R</th>
<th data-quarto-table-cell-role="th">H</th>
<th data-quarto-table-cell-role="th">doubles</th>
<th data-quarto-table-cell-role="th">triples</th>
<th data-quarto-table-cell-role="th">HR</th>
<th data-quarto-table-cell-role="th">RBI</th>
<th data-quarto-table-cell-role="th">walks</th>
<th data-quarto-table-cell-role="th">strike_outs</th>
<th data-quarto-table-cell-role="th">stolen_bases</th>
<th data-quarto-table-cell-role="th">caught_stealing_base</th>
<th data-quarto-table-cell-role="th">AVG</th>
<th data-quarto-table-cell-role="th">OBP</th>
<th data-quarto-table-cell-role="th">SLG</th>
<th data-quarto-table-cell-role="th">OPS</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Allard, K</td>
<td>ATL</td>
<td>P</td>
<td>3</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>2.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Gibson, K</td>
<td>MIN</td>
<td>P</td>
<td>1</td>
<td>2</td>
<td>2</td>
<td>2</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>2.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Law, D</td>
<td>SF</td>
<td>P</td>
<td>7</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>2.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Nuno, V</td>
<td>TB</td>
<td>P</td>
<td>1</td>
<td>2</td>
<td>0</td>
<td>2</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>2.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Romero, E</td>
<td>KC</td>
<td>P</td>
<td>4</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1.0</td>
<td>1.0</td>
<td>2.0</td>
<td>3.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<div id="tabset-1-2">
<div style="text-align: center;">
<iframe width="1200" height="400" src="https://openintrostat.github.io/openintro/reference/mlb_players_18.html" frameborder="1" style="background:white;"></iframe>
</div>
</div>
<div id="tabset-1-3">
<div id="dc07ef85" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a></a>mlb_players_18.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 1270 entries, 0 to 1269
Data columns (total 19 columns):
 #   Column                Non-Null Count  Dtype  
---  ------                --------------  -----  
 0   name                  1270 non-null   object 
 1   team                  1270 non-null   object 
 2   position              1270 non-null   object 
 3   games                 1270 non-null   int64  
 4   AB                    1270 non-null   int64  
 5   R                     1270 non-null   int64  
 6   H                     1270 non-null   int64  
 7   doubles               1270 non-null   int64  
 8   triples               1270 non-null   int64  
 9   HR                    1270 non-null   int64  
 10  RBI                   1270 non-null   int64  
 11  walks                 1270 non-null   int64  
 12  strike_outs           1270 non-null   int64  
 13  stolen_bases          1270 non-null   int64  
 14  caught_stealing_base  1270 non-null   int64  
 15  AVG                   1270 non-null   float64
 16  OBP                   1270 non-null   float64
 17  SLG                   1270 non-null   float64
 18  OPS                   1270 non-null   float64
dtypes: float64(4), int64(12), object(3)
memory usage: 188.6+ KB</code></pre>
</div>
</div>
</div>
<div id="tabset-1-4">
<div id="8dd0aeb8" class="cell" data-execution_count="4">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a></a><span class="co"># Assign data</span></span>
<span id="cb5-2"><a></a>df <span class="op">=</span> mlb_players_18</span>
<span id="cb5-3"><a></a></span>
<span id="cb5-4"><a></a><span class="co"># Select categorical columns</span></span>
<span id="cb5-5"><a></a>categorical_cols <span class="op">=</span> df.columns</span>
<span id="cb5-6"><a></a></span>
<span id="cb5-7"><a></a><span class="co"># Initialize a dictionary to store results</span></span>
<span id="cb5-8"><a></a>category_analysis <span class="op">=</span> {}</span>
<span id="cb5-9"><a></a></span>
<span id="cb5-10"><a></a><span class="co"># Loop through each categorical column</span></span>
<span id="cb5-11"><a></a><span class="cf">for</span> col <span class="kw">in</span> categorical_cols:</span>
<span id="cb5-12"><a></a>    counts <span class="op">=</span> df[col].value_counts()</span>
<span id="cb5-13"><a></a>    proportions <span class="op">=</span> df[col].value_counts(normalize<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb5-14"><a></a>    unique_levels <span class="op">=</span> df[col].unique()</span>
<span id="cb5-15"><a></a>    </span>
<span id="cb5-16"><a></a>    <span class="co"># Store results in dictionary</span></span>
<span id="cb5-17"><a></a>    category_analysis[col] <span class="op">=</span> {</span>
<span id="cb5-18"><a></a>        <span class="st">'Unique Levels'</span>: unique_levels,</span>
<span id="cb5-19"><a></a>        <span class="st">'Counts'</span>: counts,</span>
<span id="cb5-20"><a></a>        <span class="st">'Proportions'</span>: proportions</span>
<span id="cb5-21"><a></a>    }</span>
<span id="cb5-22"><a></a></span>
<span id="cb5-23"><a></a><span class="co"># Print results</span></span>
<span id="cb5-24"><a></a><span class="cf">for</span> col, data <span class="kw">in</span> category_analysis.items():</span>
<span id="cb5-25"><a></a>    <span class="bu">print</span>(<span class="ss">f"Analysis for </span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">:</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb5-26"><a></a>    <span class="bu">print</span>(<span class="st">"Unique Levels:"</span>, data[<span class="st">'Unique Levels'</span>])</span>
<span id="cb5-27"><a></a>    <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Counts:</span><span class="ch">\n</span><span class="st">"</span>, data[<span class="st">'Counts'</span>])</span>
<span id="cb5-28"><a></a>    <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Proportions:</span><span class="ch">\n</span><span class="st">"</span>, data[<span class="st">'Proportions'</span>])</span>
<span id="cb5-29"><a></a>    <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="op">+</span> <span class="st">"-"</span><span class="op">*</span><span class="dv">50</span> <span class="op">+</span> <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis for name:

Unique Levels: [' Allard, K' ' Gibson, K' ' Law, D' ... ' Zamora, D' ' Zastryzny, R'
 ' Ziegler, B']

Counts:
 name
Anderson, T    3
Garcia, J      3
Guerra, J      3
Sanchez, A     3
Santana, D     3
              ..
Taylor, M      1
Bour, J        1
Flowers, T     1
Davidson, M    1
Ziegler, B     1
Name: count, Length: 1224, dtype: int64

Proportions:
 name
Anderson, T    0.002362
Garcia, J      0.002362
Guerra, J      0.002362
Sanchez, A     0.002362
Santana, D     0.002362
                 ...   
Taylor, M      0.000787
Bour, J        0.000787
Flowers, T     0.000787
Davidson, M    0.000787
Ziegler, B     0.000787
Name: proportion, Length: 1224, dtype: float64

--------------------------------------------------

Analysis for team:

Unique Levels: ['ATL' 'MIN' 'SF' 'TB' 'KC' 'CHC' 'MIL' 'PIT' 'SEA' 'NYM' 'CWS' 'COL'
 'LAD' 'BOS' 'MIA' 'NYY' 'TOR' 'WSH' 'LAA' 'OAK' 'TEX' 'HOU' 'CLE' 'CIN'
 'PHI' 'STL' 'DET' 'ARI' 'BAL' 'SD']

Counts:
 team
ATL    53
NYM    51
LAD    50
MIL    49
CHC    48
ARI    47
CIN    46
SF     45
STL    45
WSH    45
MIA    44
DET    44
PHI    43
TOR    43
SD     43
LAA    42
COL    41
OAK    41
BAL    41
BOS    40
SEA    40
PIT    40
TB     39
TEX    38
CLE    38
KC     38
NYY    38
HOU    34
MIN    32
CWS    32
Name: count, dtype: int64

Proportions:
 team
ATL    0.041732
NYM    0.040157
LAD    0.039370
MIL    0.038583
CHC    0.037795
ARI    0.037008
CIN    0.036220
SF     0.035433
STL    0.035433
WSH    0.035433
MIA    0.034646
DET    0.034646
PHI    0.033858
TOR    0.033858
SD     0.033858
LAA    0.033071
COL    0.032283
OAK    0.032283
BAL    0.032283
BOS    0.031496
SEA    0.031496
PIT    0.031496
TB     0.030709
TEX    0.029921
CLE    0.029921
KC     0.029921
NYY    0.029921
HOU    0.026772
MIN    0.025197
CWS    0.025197
Name: proportion, dtype: float64

--------------------------------------------------

Analysis for position:

Unique Levels: ['P' 'C' 'SS' 'RF' '3B' 'CF' 'LF' '2B' '1B' 'DH']

Counts:
 position
P     642
C     115
2B     83
CF     79
RF     76
3B     73
LF     70
SS     67
1B     59
DH      6
Name: count, dtype: int64

Proportions:
 position
P     0.505512
C     0.090551
2B    0.065354
CF    0.062205
RF    0.059843
3B    0.057480
LF    0.055118
SS    0.052756
1B    0.046457
DH    0.004724
Name: proportion, dtype: float64

--------------------------------------------------

Analysis for games:

Unique Levels: [  3   1   7   4  43  14  65   6  56  60  52  10  45   2   5  29 136  30
  54   9 150  63 147  47 137  23 103 140  39 154 162 143 141 111 139 152
 158 144  80  40  95  31  13 135  89  91  38 157 149 156 113  55 132  18
 146  51 116 160 148  48  21  77 138  59  82  19 104 145 142 105  24  76
  25 153 127  78  41  87 112  85 109 125 108  75  66  28 128  97 129  22
 119 102 101 151 134 123 131  68  16  26  36 126  17  15  81  61  20 130
  44  35  90  32  37  50 117  49  73 110 107 155 159  84  42  57  83 161
  98  74 114 133  11 122  92  86  94  58 124  79  33  96 115 121  46  67
  93  69 120  34  88   8 100 118  72  62  27 106  12  71  70  53  64]

Counts:
 games
1      96
2      76
3      70
4      54
5      31
       ..
150     1
120     1
93      1
135     1
98      1
Name: count, Length: 161, dtype: int64

Proportions:
 games
1      0.075591
2      0.059843
3      0.055118
4      0.042520
5      0.024409
         ...   
150    0.000787
120    0.000787
93     0.000787
135    0.000787
98     0.000787
Name: proportion, Length: 161, dtype: float64

--------------------------------------------------

Analysis for AB:

Unique Levels: [  1   2   3   6   4   7   5   8  93 520  59   9 569 225 574 143  84 534
  70 365 471 109 584 618 570 529 539 382 455 632 586 310 152 319  10  60
 487 504 281 328 134 620 623 573 590 280 480 503 433  58  99 140 560 123
 554 171 414 598 626 537 606  31 579 593 462 513 156 302 559 178 594 444
 252  63 326 596 401 398  74 215  53 527 566 486 249 580 582 250 100 261
 165 413 547 288 321 415 661 318 477 463 293 275 210 533 494  40 284 492
  11 396  66 389 257 464 151 431 258 664 347 440 296 578  26 432 556 546
 101 116 176 386  15 405 169 617 403 211 283  34 136 544 597 223 499 174
 106 379 395  19 190 422 255 141 282 351 149 344  65 501 459 639 356 437
 330 557  50  77 466 131  27 332 170 236 298 489 564 265 519 402 407 380
 550 110 531 177 358 130 524 461 536  75 312 474 316 399 605 613 218 119
 488 512 294 306 394 199 335 467 516  12 420 353 438 342 460 230 206 202
 602  81 576 126 500 187  61 558 424 465 506 404 213 242 197 543  33 343
 600 505 498 436  25 450 567 417 476 117 184  46 159 478 428 235 349 139
  76 203 292 555 530 348 429  68 493 510 387 128  64 278  30 133  73 146
 129  86 473  43 357 181 125 371 303 485  13 308 408 369 244 362 192 166
 434 251 423 468 221 115 452  71 373 120 196 299 532 360  18 207  36 212
 583 113 427 241 191 224  96  32 247  23 161  69 189 194  37 334 553  14
 164  94  57 238  67  91 182  48 491  29  87 214 200  44 103 325 208 323
 195  20 266 272  56 384  41 289 147 163 228  16  54  92  55 160 243 111
  78  28 118  45 135  79  17 102 470 179  72  90  24 150  49  38 122  42
  21  22  97 112  39  47  52  35  51  62   0]

Counts:
 AB
0      286
1       92
2       64
3       35
4       28
      ... 
335      1
467      1
420      1
438      1
605      1
Name: count, Length: 389, dtype: int64

Proportions:
 AB
0      0.225197
1      0.072441
2      0.050394
3      0.027559
4      0.022047
         ...   
335    0.000787
467    0.000787
420    0.000787
438    0.000787
605    0.000787
Name: proportion, Length: 389, dtype: float64

--------------------------------------------------

Analysis for R:

Unique Levels: [  1   2   0   9 129   4 111  35 118  30  11  84  10  62 101  15  86  94
  89  88  90  39  67  64  91  44  17  55   3  65  38  40  78  83 104  26
  59  75  68  21  77 119  70   5 103  95  72  27   8  87  85  19 105  33
  52  47  79  74  54  69  28  36  76 100  43  81  41  49  71 102  80  31
  50  37  63  23  45  48 110  13  60   7  56  22  61  25  20  46  53  16
  29  82  14  66  42  32  12  34  98  57  51  73  24   6  18]

Counts:
 R
0      562
1       83
2       52
3       28
4       22
      ... 
98       1
57       1
118      1
100      1
104      1
Name: count, Length: 105, dtype: int64

Proportions:
 R
0      0.442520
1      0.065354
2      0.040945
3      0.022047
4      0.017323
         ...   
98     0.000787
57     0.000787
118    0.000787
100    0.000787
104    0.000787
Name: proportion, Length: 105, dtype: float64

--------------------------------------------------

Analysis for H:

Unique Levels: [  1   2   4   3  33 180  20 188  74 187  46  27 169  22 114 147  34 181
 191 176 163 166 117 139 192 178  94  96  18 146 151  84  98  40 185 170
 175  83  45 142 148 127  17  29  41 164  36 162  50 121 174 182 156   9
 168 172 134  87 161  51  72  93 143 113  21  61  15 149 160 137  70  28
  73 115 165 152  80 155  89 183  88 132 128  81  76  58  16 136  11  77
  78 135  68 108 118 106 154 126 119  42   7 116 141  31  47 103 159 107
  56  75 144 158  59  14 100 104   5 111  67  37  92  39  90 131 120 167
  86 145  13  44 133 101  97 140  91  19  79 153  55  30 123 129  99 105
  10 109  85  57 124  52  48   8 122   6  38 102  69 125  82  65 110 112
  71  23  24  26  53  43  32  49  54  25  35  12  66  60   0]

Counts:
 H
0      501
1       78
3       41
2       39
4       30
      ... 
151      1
191      1
140      1
153      1
187      1
Name: count, Length: 177, dtype: int64

Proportions:
 H
0      0.394488
1      0.061417
3      0.032283
2      0.030709
4      0.023622
         ...   
151    0.000787
191    0.000787
140    0.000787
153    0.000787
187    0.000787
Name: proportion, Length: 177, dtype: float64

--------------------------------------------------

Analysis for doubles:

Unique Levels: [ 0  1  2  4 47 37 11 34  5  6 29  9 31 24 30 44 36 25 22 28 43 14 18 33
 35 16 15 46 38 12 27 26 10 42 40  3 41 45 51 21 17  8  7 32 19 23 13 48
 20]

Counts:
 doubles
0     653
1      94
2      46
3      30
4      26
5      24
6      22
14     21
18     20
9      18
13     17
8      16
23     16
10     16
16     15
11     15
12     15
22     15
25     14
7      14
15     13
28     12
17     12
26     10
21      9
19      9
27      8
20      8
31      8
35      7
30      7
32      7
33      6
34      6
29      6
24      6
38      4
42      4
36      4
40      3
41      2
44      2
43      2
37      2
47      2
45      1
46      1
48      1
51      1
Name: count, dtype: int64

Proportions:
 doubles
0     0.514173
1     0.074016
2     0.036220
3     0.023622
4     0.020472
5     0.018898
6     0.017323
14    0.016535
18    0.015748
9     0.014173
13    0.013386
8     0.012598
23    0.012598
10    0.012598
16    0.011811
11    0.011811
12    0.011811
22    0.011811
25    0.011024
7     0.011024
15    0.010236
28    0.009449
17    0.009449
26    0.007874
21    0.007087
19    0.007087
27    0.006299
20    0.006299
31    0.006299
35    0.005512
30    0.005512
32    0.005512
33    0.004724
34    0.004724
29    0.004724
24    0.004724
38    0.003150
42    0.003150
36    0.003150
40    0.002362
41    0.001575
44    0.001575
43    0.001575
37    0.001575
47    0.001575
45    0.000787
46    0.000787
48    0.000787
51    0.000787
Name: proportion, dtype: float64

--------------------------------------------------

Analysis for triples:

Unique Levels: [ 0  1  5  2  6  7  4  3 10  9  8 12]

Counts:
 triples
0     941
1     128
2      81
3      48
4      24
5      15
6      12
7       9
8       6
9       3
10      2
12      1
Name: count, dtype: int64

Proportions:
 triples
0     0.740945
1     0.100787
2     0.063780
3     0.037795
4     0.018898
5     0.011811
6     0.009449
7     0.007087
8     0.004724
9     0.002362
10    0.001575
12    0.000787
Name: proportion, dtype: float64

--------------------------------------------------

Analysis for HR:

Unique Levels: [ 0  2  3 32  1 43 36 15 13  4 14 39 23 17 24 10  9 12  5  7 37 27 38 11
 26 30 22 29 34 16 33 21  6 31 25 20  8 35 19 18 28 48 40]

Counts:
 HR
0     734
1      92
2      42
3      35
4      31
6      28
5      22
9      22
11     21
8      18
10     16
7      16
13     15
15     14
12     13
16     13
17     12
20     12
14     12
21     11
23     11
24      9
22      9
19      7
18      7
27      7
25      6
34      4
26      4
37      3
32      3
30      3
38      3
29      2
39      2
36      2
35      2
28      2
31      1
43      1
33      1
48      1
40      1
Name: count, dtype: int64

Proportions:
 HR
0     0.577953
1     0.072441
2     0.033071
3     0.027559
4     0.024409
6     0.022047
5     0.017323
9     0.017323
11    0.016535
8     0.014173
10    0.012598
7     0.012598
13    0.011811
15    0.011024
12    0.010236
16    0.010236
17    0.009449
20    0.009449
14    0.009449
21    0.008661
23    0.008661
24    0.007087
22    0.007087
19    0.005512
18    0.005512
27    0.005512
25    0.004724
34    0.003150
26    0.003150
37    0.002362
32    0.002362
30    0.002362
38    0.002362
29    0.001575
39    0.001575
36    0.001575
35    0.001575
28    0.001575
31    0.000787
43    0.000787
33    0.000787
48    0.000787
40    0.000787
Name: proportion, dtype: float64

--------------------------------------------------

Analysis for RBI:

Unique Levels: [  0   1   2   3  21  80   6 130  19 110  36   9  61  14  52  79  15  92
  98  76  38  70  58  83  60  63  50  12  33   5  55  43  42  22  89 107
  93  51  40  44  64   7  16  87  75 108  85 111  10   4 103  77  17  41
  34  67  53  11 104 101  48  35  88  39  31  18  54  68  72  46  74  37
  62  30  25  65  84  32  73  57  45 105  86  13  99 100  20  71  28  78
  23  47  29   8  59  27  81  97  49  24  69  95  56 123  96  82  66  26]

Counts:
 RBI
0      596
1       73
2       38
4       29
3       24
      ... 
101      1
104      1
111      1
89       1
26       1
Name: count, Length: 108, dtype: int64

Proportions:
 RBI
0      0.469291
1      0.057480
2      0.029921
4      0.022835
3      0.018898
         ...   
101    0.000787
104    0.000787
111    0.000787
89     0.000787
26     0.000787
Name: proportion, Length: 108, dtype: float64

--------------------------------------------------

Analysis for walks:

Unique Levels: [  0   1   2  81   3  69  14  68  17   8  55  47 122  11  42  76  48  71
  32  49  61   5  38  37  21  20  22  70  72  25  73  24  45   7  12  35
  10  79  59  23  29  90  36  16   4  30  96 108  64  51   9  58  31  39
  67  15  19  62  60  34  52  26 106  33   6  78  18  28  92  80  13  43
  44  41  77  54  27  40 102  50  95 130  53  63  87  84  83  46  65 110
  66  74  56]

Counts:
 walks
0      591
1       88
2       51
3       29
4       25
      ... 
108      1
122      1
68       1
81       1
56       1
Name: count, Length: 93, dtype: int64

Proportions:
 walks
0      0.465354
1      0.069291
2      0.040157
3      0.022835
4      0.019685
         ...   
108    0.000787
122    0.000787
68     0.000787
81     0.000787
56     0.000787
Name: proportion, Length: 93, dtype: float64

--------------------------------------------------

Analysis for strike_outs:

Unique Levels: [  0   1   3   5  91   9   2 146  24 135  43  12  79  21  54 124  19 125
 132  60  82  94  80 104 114  69  47  29  64  11  96  46  40  27 151  97
 122  72  36  98  93 123  32  44  18  99 168 134  63 167 106 173 115 102
  50  62  75  85  83  31 148 101  53  41 142  86  59 110  38  16 152  95
 109  73 107 113  71  77  49   8 140  65  34 143  68 129  22  61 126 108
  37  13  17  15  45  42 128   4  87 211 119 156  20  55 131 138  66 116
  84  14  35  88 158 176 100  58  78 111 145  25  30  57 117 178  23 127
 155  33 103   6 169 121  89  52  67 147 163 175 150 133 159 153 149 217
 137  10  28  90  74 112 165  76  39 160  48   7  26 207 120  51 192  70]

Counts:
 strike_outs
0      351
1      122
2       52
3       31
4       23
      ... 
155      1
169      1
89       1
147      1
70       1
Name: count, Length: 162, dtype: int64

Proportions:
 strike_outs
0      0.276378
1      0.096063
2      0.040945
3      0.024409
4      0.018110
         ...   
155    0.000787
169    0.000787
89     0.000787
147    0.000787
70     0.000787
Name: proportion, Length: 162, dtype: float64

--------------------------------------------------

Analysis for stolen_bases:

Unique Levels: [ 0 30  3  2  6  7 22  1 17 24  4 10 12 45 20  9 16  8 14 40  5 27 21 23
 11 33 25 32 15 43 34 28 35 13 19 26]

Counts:
 stolen_bases
0     862
1     104
2      70
3      45
4      26
5      24
6      23
7      17
12     12
10     12
8       9
9       7
14      7
11      6
16      6
13      5
15      4
24      4
21      4
30      3
20      3
17      2
34      2
19      1
35      1
28      1
43      1
45      1
32      1
25      1
33      1
23      1
27      1
22      1
40      1
26      1
Name: count, dtype: int64

Proportions:
 stolen_bases
0     0.678740
1     0.081890
2     0.055118
3     0.035433
4     0.020472
5     0.018898
6     0.018110
7     0.013386
12    0.009449
10    0.009449
8     0.007087
9     0.005512
14    0.005512
11    0.004724
16    0.004724
13    0.003937
15    0.003150
24    0.003150
21    0.003150
30    0.002362
20    0.002362
17    0.001575
34    0.001575
19    0.000787
35    0.000787
28    0.000787
43    0.000787
45    0.000787
32    0.000787
25    0.000787
33    0.000787
23    0.000787
27    0.000787
22    0.000787
40    0.000787
26    0.000787
Name: proportion, dtype: float64

--------------------------------------------------

Analysis for caught_stealing_base:

Unique Levels: [ 0  6  1  4  2  3  7 10 11 12  5  9 14  8]

Counts:
 caught_stealing_base
0     942
1     117
2      70
3      46
4      35
6      18
5      18
7       8
10      4
12      3
9       3
11      2
14      2
8       2
Name: count, dtype: int64

Proportions:
 caught_stealing_base
0     0.741732
1     0.092126
2     0.055118
3     0.036220
4     0.027559
6     0.014173
5     0.014173
7     0.006299
10    0.003150
12    0.002362
9     0.002362
11    0.001575
14    0.001575
8     0.001575
Name: proportion, dtype: float64

--------------------------------------------------

Analysis for AVG:

Unique Levels: [1.    0.667 0.5   0.429 0.4   0.375 0.355 0.346 0.339 0.333 0.33  0.329
 0.326 0.322 0.321 0.316 0.314 0.312 0.31  0.309 0.308 0.306 0.305 0.304
 0.303 0.301 0.3   0.299 0.298 0.297 0.296 0.294 0.293 0.292 0.291 0.29
 0.288 0.287 0.286 0.285 0.284 0.283 0.282 0.281 0.28  0.279 0.278 0.277
 0.276 0.275 0.274 0.273 0.272 0.271 0.27  0.269 0.268 0.267 0.266 0.265
 0.264 0.263 0.262 0.261 0.26  0.259 0.258 0.257 0.256 0.255 0.254 0.253
 0.252 0.251 0.25  0.249 0.248 0.247 0.246 0.245 0.244 0.243 0.242 0.241
 0.24  0.239 0.238 0.237 0.236 0.235 0.234 0.233 0.232 0.231 0.23  0.229
 0.228 0.227 0.226 0.225 0.224 0.223 0.222 0.221 0.22  0.219 0.217 0.216
 0.215 0.214 0.213 0.212 0.211 0.21  0.209 0.208 0.207 0.206 0.205 0.204
 0.203 0.202 0.201 0.2   0.199 0.198 0.197 0.196 0.195 0.194 0.192 0.19
 0.189 0.188 0.187 0.186 0.185 0.184 0.183 0.182 0.181 0.18  0.179 0.178
 0.177 0.176 0.175 0.174 0.173 0.17  0.169 0.168 0.167 0.165 0.164 0.163
 0.162 0.161 0.16  0.159 0.158 0.156 0.154 0.152 0.15  0.148 0.147 0.143
 0.141 0.14  0.138 0.136 0.135 0.134 0.133 0.13  0.128 0.125 0.122 0.12
 0.119 0.118 0.117 0.116 0.115 0.114 0.111 0.109 0.108 0.105 0.103 0.102
 0.1   0.095 0.094 0.093 0.092 0.091 0.089 0.088 0.087 0.083 0.08  0.078
 0.077 0.075 0.07  0.067 0.065 0.064 0.063 0.059 0.057 0.056 0.052 0.048
 0.045 0.044 0.042 0.038 0.034 0.024 0.019 0.   ]

Counts:
 AVG
0.000    501
0.167     20
0.200     18
0.250     17
0.333     14
        ... 
0.375      1
0.169      1
0.170      1
0.173      1
0.197      1
Name: count, Length: 224, dtype: int64

Proportions:
 AVG
0.000    0.394488
0.167    0.015748
0.200    0.014173
0.250    0.013386
0.333    0.011024
           ...   
0.375    0.000787
0.169    0.000787
0.170    0.000787
0.173    0.000787
0.197    0.000787
Name: proportion, Length: 224, dtype: float64

--------------------------------------------------

Analysis for OBP:

Unique Levels: [1.    0.667 0.5   0.429 0.333 0.375 0.371 0.438 0.4   0.402 0.381 0.398
 0.394 0.386 0.329 0.406 0.46  0.357 0.388 0.364 0.374 0.395 0.358 0.378
 0.367 0.341 0.331 0.3   0.417 0.354 0.33  0.405 0.336 0.366 0.328 0.359
 0.397 0.361 0.349 0.34  0.355 0.352 0.337 0.348 0.323 0.326 0.389 0.338
 0.36  0.345 0.325 0.339 0.308 0.286 0.342 0.304 0.415 0.376 0.351 0.309
 0.313 0.335 0.294 0.322 0.392 0.356 0.327 0.362 0.35  0.306 0.288 0.321
 0.396 0.316 0.273 0.385 0.334 0.303 0.344 0.332 0.314 0.387 0.31  0.29
 0.319 0.353 0.267 0.343 0.39  0.301 0.346 0.289 0.295 0.377 0.391 0.404
 0.382 0.324 0.347 0.305 0.312 0.317 0.368 0.318 0.287 0.307 0.297 0.282
 0.274 0.315 0.25  0.293 0.222 0.393 0.302 0.311 0.299 0.279 0.292 0.281
 0.235 0.298 0.291 0.28  0.268 0.277 0.269 0.285 0.253 0.275 0.266 0.283
 0.284 0.278 0.252 0.258 0.276 0.262 0.271 0.225 0.256 0.255 0.263 0.254
 0.239 0.296 0.242 0.236 0.214 0.211 0.26  0.247 0.264 0.257 0.265 0.272
 0.261 0.226 0.244 0.248 0.259 0.2   0.24  0.193 0.209 0.221 0.217 0.188
 0.241 0.207 0.218 0.245 0.232 0.227 0.19  0.191 0.224 0.243 0.143 0.167
 0.194 0.184 0.161 0.203 0.192 0.174 0.179 0.183 0.154 0.15  0.237 0.246
 0.178 0.208 0.136 0.175 0.21  0.204 0.171 0.125 0.176 0.163 0.119 0.118
 0.162 0.156 0.148 0.233 0.115 0.114 0.205 0.111 0.172 0.103 0.131 0.1
 0.17  0.094 0.093 0.091 0.231 0.089 0.139 0.16  0.083 0.096 0.127 0.077
 0.075 0.109 0.086 0.067 0.097 0.065 0.102 0.063 0.158 0.123 0.074 0.105
 0.056 0.052 0.045 0.061 0.038 0.048 0.019 0.    0.095]

Counts:
 OBP
0.000    474
0.333     28
0.250     20
0.200     19
0.500     18
        ... 
0.227      1
0.232      1
0.245      1
0.218      1
0.095      1
Name: count, Length: 249, dtype: int64

Proportions:
 OBP
0.000    0.373228
0.333    0.022047
0.250    0.015748
0.200    0.014961
0.500    0.014173
           ...   
0.227    0.000787
0.232    0.000787
0.245    0.000787
0.218    0.000787
0.095    0.000787
Name: proportion, Length: 249, dtype: float64

--------------------------------------------------

Analysis for SLG:

Unique Levels: [1.    2.    0.833 0.5   0.714 0.4   0.6   1.125 0.516 0.64  0.39  0.333
 1.333 0.667 0.629 0.471 0.598 0.671 0.452 0.451 0.614 0.518 0.628 0.422
 0.49  0.505 0.468 0.535 0.417 0.487 0.44  0.457 0.438 0.415 0.474 0.411
 0.3   0.35  0.435 0.431 0.454 0.448 0.538 0.527 0.561 0.414 0.406 0.366
 0.552 0.483 0.364 0.45  0.398 0.38  0.517 0.567 0.502 0.428 0.554 0.71
 0.581 0.465 0.533 0.481 0.522 0.525 0.427 0.479 0.416 0.461 0.532 0.378
 0.492 0.286 0.564 0.493 0.419 0.372 0.382 0.392 0.512 0.434 0.526 0.47
 0.379 0.446 0.433 0.42  0.37  0.498 0.528 0.508 0.46  0.407 0.519 0.456
 0.484 0.467 0.413 0.345 0.464 0.429 0.363 0.539 0.534 0.273 0.384 0.53
 0.545 0.489 0.344 0.48  0.376 0.444 0.395 0.466 0.346 0.308 0.389 0.349
 0.494 0.347 0.491 0.396 0.388 0.386 0.267 0.331 0.509 0.449 0.412 0.473
 0.353 0.375 0.421 0.356 0.292 0.486 0.582 0.453 0.408 0.496 0.458 0.597
 0.477 0.436 0.357 0.403 0.52  0.377 0.437 0.523 0.463 0.343 0.381 0.367
 0.425 0.439 0.424 0.469 0.394 0.332 0.499 0.32  0.362 0.404 0.462 0.426
 0.459 0.307 0.25  0.34  0.55  0.625 0.336 0.504 0.476 0.409 0.432 0.549
 0.397 0.279 0.326 0.305 0.271 0.325 0.418 0.385 0.283 0.405 0.374 0.373
 0.355 0.342 0.327 0.368 0.324 0.359 0.289 0.297 0.266 0.391 0.317 0.315
 0.304 0.291 0.313 0.262 0.328 0.33  0.387 0.338 0.423 0.351 0.36  0.393
 0.281 0.354 0.278 0.348 0.288 0.314 0.369 0.335 0.321 0.478 0.217 0.371
 0.216 0.312 0.214 0.309 0.383 0.242 0.339 0.399 0.263 0.244 0.239 0.231
 0.253 0.264 0.241 0.302 0.29  0.258 0.205 0.303 0.41  0.2   0.24  0.272
 0.8   0.316 0.213 0.232 0.28  0.365 0.268 0.301 0.211 0.259 0.257 0.188
 0.306 0.185 0.294 0.269 0.298 0.284 0.176 0.223 0.261 0.26  0.247 0.296
 0.167 0.319 0.238 0.274 0.204 0.179 0.163 0.27  0.194 0.16  0.158 0.246
 0.154 0.152 0.175 0.148 0.235 0.143 0.224 0.254 0.203 0.138 0.136 0.135
 0.165 0.222 0.17  0.125 0.122 0.169 0.116 0.115 0.114 0.111 0.105 0.172
 0.128 0.119 0.1   0.19  0.094 0.093 0.123 0.159 0.091 0.089 0.088 0.13
 0.083 0.08  0.098 0.077 0.103 0.075 0.067 0.097 0.065 0.064 0.063 0.059
 0.057 0.056 0.069 0.048 0.045 0.038 0.034 0.024 0.019 0.   ]

Counts:
 SLG
0.000    501
0.333     19
0.250     17
0.200     15
0.500     14
        ... 
0.549      1
0.397      1
0.418      1
0.405      1
0.625      1
Name: count, Length: 346, dtype: int64

Proportions:
 SLG
0.000    0.394488
0.333    0.014961
0.250    0.013386
0.200    0.011811
0.500    0.011024
           ...   
0.549    0.000787
0.397    0.000787
0.418    0.000787
0.405    0.000787
0.625    0.000787
Name: proportion, Length: 346, dtype: float64

--------------------------------------------------

Analysis for OPS:

Unique Levels: [2.    3.    1.667 1.5   1.    1.167 1.143 0.733 1.1   0.887 1.078 0.765
 0.667 0.762 1.067 1.031 0.852 1.069 0.846 0.837 0.943 0.924 1.088 0.797
 0.847 0.892 0.832 0.909 0.813 0.845 0.817 0.821 0.806 0.755 0.805 0.6
 0.65  0.789 0.804 0.836 0.79  0.843 0.854 0.905 0.855 0.935 0.83  0.811
 0.773 0.727 0.917 0.703 0.868 0.729 0.754 0.728 0.923 0.914 0.86  0.751
 0.881 1.043 0.922 0.818 0.883 0.874 0.803 0.742 0.785 0.926 0.701 0.792
 0.8   0.571 0.925 0.859 0.714 0.741 0.696 0.89  0.849 0.732 0.758 0.664
 0.838 0.704 0.919 0.864 0.787 0.774 0.747 0.871 0.798 0.825 0.796 0.763
 0.888 0.633 0.749 0.794 0.678 0.757 0.545 0.93  0.834 0.824 0.722 0.82
 0.679 0.76  0.776 0.731 0.78  0.939 0.668 0.629 0.699 0.637 0.829 0.744
 0.697 0.676 0.736 0.801 0.533 0.672 0.74  0.786 0.743 0.705 0.677 0.651
 0.81  0.735 0.623 0.756 0.973 0.886 0.863 0.723 0.95  0.768 0.75  0.682
 0.764 0.715 0.814 0.882 0.706 0.709 0.619 0.809 0.71  0.769 0.753 0.897
 0.808 0.654 0.85  0.675 0.693 0.777 0.73  0.669 0.782 0.719 0.708 0.639
 0.793 0.839 0.775 0.816 0.626 0.718 0.72  0.643 0.702 0.64  0.68  0.738
 0.5   0.9   0.583 0.656 0.472 0.657 0.958 0.778 0.889 0.645 0.662 0.833
 0.724 0.7   0.779 0.624 0.788 0.592 0.694 0.713 0.617 0.815 0.746 0.681
 0.865 0.687 0.771 0.684 0.622 0.823 0.634 0.661 0.69  0.576 0.614 0.635
 0.688 0.671 0.613 0.566 0.567 0.717 0.602 0.581 0.557 0.761 0.608 0.597
 0.683 0.642 0.604 0.711 0.593 0.653 0.649 0.546 0.767 0.673 0.766 0.644
 0.655 0.648 0.611 0.565 0.605 0.59  0.627 0.555 0.475 0.559 0.61  0.541
 0.652 0.526 0.591 0.575 0.658 0.609 0.783 0.467 0.584 0.58  0.485 0.618
 0.589 0.429 0.712 0.558 0.674 0.621 0.474 0.685 0.504 0.523 0.478 0.63
 0.54  0.529 0.499 0.691 0.574 0.552 0.553 0.519 0.603 0.46  0.599 0.692
 0.51  0.551 0.4   0.544 0.473 1.229 0.435 0.739 0.588 0.577 0.547 0.425
 0.663 0.486 0.433 0.564 0.539 0.528 0.423 0.438 0.532 0.501 0.399 0.631
 0.582 0.455 0.516 0.628 0.698 0.421 0.578 0.511 0.562 0.549 0.477 0.44
 0.471 0.452 0.464 0.615 0.31  0.333 0.56  0.417 0.394 0.492 0.42  0.487
 0.39  0.363 0.454 0.355 0.382 0.352 0.378 0.337 0.383 0.462 0.368 0.34
 0.325 0.327 0.495 0.357 0.36  0.286 0.47  0.392 0.393 0.432 0.439 0.299
 0.403 0.273 0.406 0.451 0.388 0.426 0.52  0.376 0.313 0.25  0.301 0.285
 0.288 0.294 0.373 0.272 0.264 0.269 0.314 0.319 0.311 0.222 0.395 0.444
 0.424 0.341 0.296 0.276 0.328 0.267 0.268 0.2   0.289 0.346 0.188 0.219
 0.186 0.242 0.53  0.258 0.209 0.322 0.182 0.178 0.227 0.29  0.35  0.208
 0.195 0.194 0.243 0.154 0.185 0.174 0.133 0.18  0.191 0.323 0.158 0.166
 0.156 0.259 0.213 0.179 0.15  0.161 0.139 0.121 0.128 0.248 0.091 0.132
 0.124 0.077 0.131 0.072 0.038 0.    0.095 0.1   0.167 0.125 0.083]

Counts:
 OPS
0.000    474
0.500     17
0.333     11
0.667     11
1.000     10
        ... 
0.683      1
0.604      1
0.711      1
0.593      1
0.083      1
Name: count, Length: 443, dtype: int64

Proportions:
 OPS
0.000    0.373228
0.500    0.013386
0.333    0.008661
0.667    0.008661
1.000    0.007874
           ...   
0.683    0.000787
0.604    0.000787
0.711    0.000787
0.593    0.000787
0.083    0.000787
Name: proportion, Length: 443, dtype: float64

--------------------------------------------------
</code></pre>
</div>
</div>
</div>
<div id="tabset-1-5">
<div id="835e81c3" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a></a>mlb_players_18.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">games</th>
<th data-quarto-table-cell-role="th">AB</th>
<th data-quarto-table-cell-role="th">R</th>
<th data-quarto-table-cell-role="th">H</th>
<th data-quarto-table-cell-role="th">doubles</th>
<th data-quarto-table-cell-role="th">triples</th>
<th data-quarto-table-cell-role="th">HR</th>
<th data-quarto-table-cell-role="th">RBI</th>
<th data-quarto-table-cell-role="th">walks</th>
<th data-quarto-table-cell-role="th">strike_outs</th>
<th data-quarto-table-cell-role="th">stolen_bases</th>
<th data-quarto-table-cell-role="th">caught_stealing_base</th>
<th data-quarto-table-cell-role="th">AVG</th>
<th data-quarto-table-cell-role="th">OBP</th>
<th data-quarto-table-cell-role="th">SLG</th>
<th data-quarto-table-cell-role="th">OPS</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>1270.000000</td>
<td>1270.000000</td>
<td>1270.000000</td>
<td>1270.000000</td>
<td>1270.000000</td>
<td>1270.000000</td>
<td>1270.000000</td>
<td>1270.000000</td>
<td>1270.000000</td>
<td>1270.000000</td>
<td>1270.000000</td>
<td>1270.000000</td>
<td>1270.000000</td>
<td>1270.000000</td>
<td>1270.000000</td>
<td>1270.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>48.171654</td>
<td>130.261417</td>
<td>17.031496</td>
<td>32.297638</td>
<td>6.507087</td>
<td>0.666929</td>
<td>4.397638</td>
<td>16.225197</td>
<td>12.351181</td>
<td>32.446457</td>
<td>1.948031</td>
<td>0.754331</td>
<td>0.140191</td>
<td>0.181824</td>
<td>0.217412</td>
<td>0.399239</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>49.957749</td>
<td>185.855484</td>
<td>26.896304</td>
<td>49.396815</td>
<td>10.487391</td>
<td>1.517461</td>
<td>8.036863</td>
<td>26.085535</td>
<td>20.680606</td>
<td>44.687302</td>
<td>5.018058</td>
<td>1.769933</td>
<td>0.140268</td>
<td>0.165976</td>
<td>0.218611</td>
<td>0.374984</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">min</td>
<td>1.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25%</td>
<td>5.000000</td>
<td>1.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50%</td>
<td>29.000000</td>
<td>23.500000</td>
<td>1.000000</td>
<td>3.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>8.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.166000</td>
<td>0.217500</td>
<td>0.214000</td>
<td>0.436500</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75%</td>
<td>79.750000</td>
<td>213.750000</td>
<td>27.000000</td>
<td>50.000000</td>
<td>10.000000</td>
<td>1.000000</td>
<td>5.000000</td>
<td>24.000000</td>
<td>18.000000</td>
<td>54.000000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>0.247000</td>
<td>0.316000</td>
<td>0.395000</td>
<td>0.703000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>162.000000</td>
<td>664.000000</td>
<td>129.000000</td>
<td>192.000000</td>
<td>51.000000</td>
<td>12.000000</td>
<td>48.000000</td>
<td>130.000000</td>
<td>130.000000</td>
<td>217.000000</td>
<td>45.000000</td>
<td>14.000000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>2.000000</td>
<td>3.000000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="preprocessing" class="slide level2 smaller">
<h2>Preprocessing</h2>
<div class="panel-tabset">
<ul id="tabset-2" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-2-1">Define columns</a></li><li><a href="#tabset-2-2">Prepare steps</a></li><li><a href="#tabset-2-3">Transformations</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1">
<div id="ce8a728d" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a></a><span class="co"># Define the columns based on their type for preprocessing</span></span>
<span id="cb8-2"><a></a>categorical_features <span class="op">=</span> [<span class="st">'team'</span>, <span class="st">'position'</span>]</span>
<span id="cb8-3"><a></a>numerical_features <span class="op">=</span> [<span class="st">'games'</span>, <span class="st">'AB'</span>, <span class="st">'R'</span>, <span class="st">'H'</span>, <span class="st">'doubles'</span>, <span class="st">'triples'</span>, <span class="st">'HR'</span>, <span class="st">'RBI'</span>, <span class="st">'walks'</span>, <span class="st">'strike_outs'</span>, <span class="st">'stolen_bases'</span>, <span class="st">'caught_stealing_base'</span>, <span class="st">'AVG'</span>, <span class="st">'OBP'</span>, <span class="st">'SLG'</span>, <span class="st">'OPS'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-2-2">
<div id="43215aa6" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a></a><span class="co"># Handling missing values: Impute missing values if any</span></span>
<span id="cb9-2"><a></a><span class="co"># For numerical features, replace missing values with the median of the column</span></span>
<span id="cb9-3"><a></a><span class="co"># For categorical features, replace missing values with the most frequent value of the column</span></span>
<span id="cb9-4"><a></a>numerical_transformer <span class="op">=</span> Pipeline(steps <span class="op">=</span> [</span>
<span id="cb9-5"><a></a>    (<span class="st">'imputer'</span>, SimpleImputer(strategy <span class="op">=</span> <span class="st">'median'</span>)),</span>
<span id="cb9-6"><a></a>    (<span class="st">'scaler'</span>, StandardScaler())])</span>
<span id="cb9-7"><a></a></span>
<span id="cb9-8"><a></a>categorical_transformer <span class="op">=</span> Pipeline(steps <span class="op">=</span> [</span>
<span id="cb9-9"><a></a>    (<span class="st">'onehot'</span>, OneHotEncoder(handle_unknown <span class="op">=</span> <span class="st">'ignore'</span>))])</span>
<span id="cb9-10"><a></a></span>
<span id="cb9-11"><a></a>preprocessor <span class="op">=</span> ColumnTransformer(transformers <span class="op">=</span> [</span>
<span id="cb9-12"><a></a>    (<span class="st">'num'</span>, numerical_transformer, numerical_features),</span>
<span id="cb9-13"><a></a>    (<span class="st">'cat'</span>, categorical_transformer, categorical_features)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-2-3">
<div id="23daac97" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a></a><span class="co"># Apply the transformations to the dataset</span></span>
<span id="cb10-2"><a></a>mlb_preprocessed <span class="op">=</span> preprocessor.fit_transform(mlb_players_18)</span>
<span id="cb10-3"><a></a></span>
<span id="cb10-4"><a></a><span class="co"># The result is a NumPy array. To convert it back to a DataFrame:</span></span>
<span id="cb10-5"><a></a><span class="co"># Update the method to get_feature_names_out for compatibility with newer versions of scikit-learn</span></span>
<span id="cb10-6"><a></a>feature_names <span class="op">=</span> <span class="bu">list</span>(preprocessor.named_transformers_[<span class="st">'cat'</span>].named_steps[<span class="st">'onehot'</span>].get_feature_names_out(categorical_features))</span>
<span id="cb10-7"><a></a>new_columns <span class="op">=</span> numerical_features <span class="op">+</span> feature_names</span>
<span id="cb10-8"><a></a></span>
<span id="cb10-9"><a></a>mlb_preprocessed_df <span class="op">=</span> pd.DataFrame(mlb_preprocessed, columns <span class="op">=</span> new_columns)</span>
<span id="cb10-10"><a></a>mlb_preprocessed_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">games</th>
<th data-quarto-table-cell-role="th">AB</th>
<th data-quarto-table-cell-role="th">R</th>
<th data-quarto-table-cell-role="th">H</th>
<th data-quarto-table-cell-role="th">doubles</th>
<th data-quarto-table-cell-role="th">triples</th>
<th data-quarto-table-cell-role="th">HR</th>
<th data-quarto-table-cell-role="th">RBI</th>
<th data-quarto-table-cell-role="th">walks</th>
<th data-quarto-table-cell-role="th">strike_outs</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">position_1B</th>
<th data-quarto-table-cell-role="th">position_2B</th>
<th data-quarto-table-cell-role="th">position_3B</th>
<th data-quarto-table-cell-role="th">position_C</th>
<th data-quarto-table-cell-role="th">position_CF</th>
<th data-quarto-table-cell-role="th">position_DH</th>
<th data-quarto-table-cell-role="th">position_LF</th>
<th data-quarto-table-cell-role="th">position_P</th>
<th data-quarto-table-cell-role="th">position_RF</th>
<th data-quarto-table-cell-role="th">position_SS</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-0.904553</td>
<td>-0.695768</td>
<td>-0.596283</td>
<td>-0.633846</td>
<td>-0.620712</td>
<td>-0.439676</td>
<td>-0.547399</td>
<td>-0.622245</td>
<td>-0.59747</td>
<td>-0.726364</td>
<td>...</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>-0.944603</td>
<td>-0.690386</td>
<td>-0.559089</td>
<td>-0.613594</td>
<td>-0.620712</td>
<td>-0.439676</td>
<td>-0.547399</td>
<td>-0.622245</td>
<td>-0.59747</td>
<td>-0.726364</td>
<td>...</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>-0.824454</td>
<td>-0.695768</td>
<td>-0.596283</td>
<td>-0.633846</td>
<td>-0.620712</td>
<td>-0.439676</td>
<td>-0.547399</td>
<td>-0.622245</td>
<td>-0.59747</td>
<td>-0.726364</td>
<td>...</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>-0.944603</td>
<td>-0.690386</td>
<td>-0.633478</td>
<td>-0.613594</td>
<td>-0.620712</td>
<td>-0.439676</td>
<td>-0.547399</td>
<td>-0.583894</td>
<td>-0.59747</td>
<td>-0.726364</td>
<td>...</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>-0.884529</td>
<td>-0.695768</td>
<td>-0.596283</td>
<td>-0.633846</td>
<td>-0.525322</td>
<td>-0.439676</td>
<td>-0.547399</td>
<td>-0.622245</td>
<td>-0.59747</td>
<td>-0.726364</td>
<td>...</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
</tbody>
</table>

<p>5 rows × 56 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
</section></section>
<section>
<section id="before-moving-on-similarity-dissimilarity" class="title-slide slide level1 center">
<h1>Before moving on: <br> Similarity / Dissimilarity</h1>

</section>
<section id="similarity-dissimilarity" class="slide level2" style="text-align: center;">
<h2>Similarity + Dissimilarity</h2>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/sim-dissim.webp" class="quarto-figure quarto-figure-center" width="567"></p>
</figure>
</div>
</section>
<section id="similarity" class="slide level2 smaller">
<h2>Similarity</h2>
<div class="panel-tabset">
<ul id="tabset-3" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-3-1">Cosine</a></li><li><a href="#tabset-3-2">Jaccard</a></li><li><a href="#tabset-3-3">Pearson <span class="math inline">\(r\)</span></a></li><li><a href="#tabset-3-4">Spearman <span class="math inline">\(\rho\)</span></a></li></ul>
<div class="tab-content">
<div id="tabset-3-1">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/cosine.jpg" class="quarto-figure quarto-figure-center" width="795"></p>
</figure>
</div>
<p><span class="math inline">\(\cos(\theta) = \frac{\mathbf{A} \cdot \mathbf{B}}{\|\mathbf{A}\| \|\mathbf{B}\|} = \frac{\sum_{i=1}^{n} A_i B_i}{\sqrt{\sum_{i=1}^{n} A_i^2} \sqrt{\sum_{i=1}^{n} B_i^2}}\)</span></p>
<ul>
<li class="fragment"><p>Best for text data or any high-dimensional data.</p></li>
<li class="fragment"><p>Useful when the magnitude of the data vector is not important.</p></li>
<li class="fragment"><p><a href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.pairwise.cosine_similarity.html">Python</a></p></li>
</ul>
</div>
<div id="tabset-3-2">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/jaccard.jpg" class="quarto-figure quarto-figure-center" width="712"></p>
</figure>
</div>
<p><span class="math inline">\(J(A, B) = \frac{|A \cap B|}{|A \cup B|}\)</span></p>
<ul>
<li class="fragment"><p>Suitable for sets or binary data.</p></li>
<li class="fragment"><p>Ideal for comparing the similarity between two sample sets.</p></li>
<li class="fragment"><p><a href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.jaccard_score.html">Python</a></p></li>
</ul>
</div>
<div id="tabset-3-3">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/pearson.png" class="quarto-figure quarto-figure-center" width="657"></p>
</figure>
</div>
<p><span class="math inline">\(r = \frac{\sum (X_i - \bar{X})(Y_i - \bar{Y})}{\sqrt{\sum (X_i - \bar{X})^2 \sum (Y_i - \bar{Y})^2}}\)</span></p>
<ul>
<li class="fragment"><p>Use when measuring the linear relationship between two continuous variables.</p></li>
<li class="fragment"><p>Appropriate for data with a normal distribution.</p></li>
<li class="fragment"><p><a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.pearsonr.html">Python</a></p></li>
</ul>
</div>
<div id="tabset-3-4">
<div class="columns">
<div class="column" style="width:33.33%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/spearman-1.png" class="quarto-figure quarto-figure-center" width="370"></p>
</figure>
</div>
</div><div class="column" style="width:33.33%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/spearman-2.png" class="quarto-figure quarto-figure-center" width="370"></p>
</figure>
</div>
</div><div class="column" style="width:33.33%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/spearman-3.png" class="quarto-figure quarto-figure-center" width="370"></p>
</figure>
</div>
</div></div>
<p><span class="math inline">\(\rho = 1 - \frac{6 \sum d_i^2}{n(n^2 - 1)}\)</span></p>
<ul>
<li class="fragment"><p>Ordinal data or when data do not meet the assumptions of Pearson’s correlation.</p></li>
<li class="fragment"><p>Monotonic relationships between two continuous or ordinal variables.</p></li>
<li class="fragment"><p><a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.spearmanr.html">Python</a></p></li>
</ul>
</div>
</div>
</div>
</section>
<section id="dissimilarity" class="slide level2 smaller">
<h2>Dissimilarity</h2>
<div class="panel-tabset">
<ul id="tabset-4" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-4-1">Euclidean</a></li><li><a href="#tabset-4-2">Manhattan</a></li><li><a href="#tabset-4-3">Hamming</a></li><li><a href="#tabset-4-4">Minkowski</a></li><li><a href="#tabset-4-5">Mahalanobis</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/euclidean.png" class="quarto-figure quarto-figure-center" width="363"></p>
</figure>
</div>
<p><span class="math inline">\(d(\mathbf{p}, \mathbf{q}) = \sqrt{\sum_{i=1}^{n} (p_i - q_i)^2}\)</span></p>
<ul>
<li class="fragment">Use for continuous data to measure the “straight line” distance between points in Euclidean space.</li>
<li class="fragment">Most common in clustering and classification where simple distance measurement is required.</li>
<li class="fragment"><a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.spatial.distance.euclidean.html">Python</a></li>
</ul>
</div>
<div id="tabset-4-2">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/manhattan.png" class="quarto-figure quarto-figure-center" width="250"></p>
</figure>
</div>
<p><span class="math inline">\(d(\mathbf{p}, \mathbf{q}) = \sum_{i=1}^{n} |p_i - q_i|\)</span></p>
<ul>
<li class="fragment">Suitable for continuous or ordinal data where you want to measure the distance as if navigating a grid-like path (like city blocks).</li>
<li class="fragment">Useful when the difference across dimensions is important regardless of the path taken.</li>
<li class="fragment"><a href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.pairwise.manhattan_distances.html">Python</a></li>
</ul>
</div>
<div id="tabset-4-3">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/hamming.jpeg" class="quarto-figure quarto-figure-center" width="362"></p>
</figure>
</div>
<p><span class="math inline">\(d(\mathbf{p}, \mathbf{q}) = \sum_{i=1}^{n} \delta(p_i, q_i) \quad \text{where} \quad \delta(a, b) = \begin{cases} 1 &amp; \text{if } a \neq b \\ 0 &amp; \text{otherwise} \end{cases}\)</span></p>
<ul>
<li class="fragment">Use for categorical or binary data.</li>
<li class="fragment">Ideal for comparing two strings of equal length or binary feature vectors.</li>
<li class="fragment"><a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.spatial.distance.hamming.html">Python</a></li>
</ul>
</div>
<div id="tabset-4-4">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/minkowski.png" class="quarto-figure quarto-figure-center" width="1209"></p>
</figure>
</div>
<p><span class="math inline">\(d(\mathbf{p}, \mathbf{q}) = \left( \sum_{i=1}^{n} |p_i - q_i|^p \right)^{\frac{1}{p}}\)</span></p>
<ul>
<li class="fragment">A generalization of Euclidean and Manhattan distances. Use when you need to fine-tune the distance calculation by emphasizing different dimensions.</li>
<li class="fragment">Parameterizable for different applications; adjust the parameter to control the impact of different dimensions.</li>
<li class="fragment"><a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.spatial.distance.minkowski.html">Python</a></li>
</ul>
</div>
<div id="tabset-4-5">
<div class="columns">
<div class="column" style="width:50%;">
<div id="e39aa322" class="cell" data-execution_count="9">
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="11-unsupervised-1_files/figure-revealjs/cell-10-output-1.png" width="516" height="381"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<p><span class="math display">\[d(\mathbf{x}, \mathbf{y}) = \sqrt{(\mathbf{x} - \mathbf{y})^T S^{-1} (\mathbf{x} - \mathbf{y})}\]</span></p>
<ul>
<li class="fragment"><p>Best for multivariate data where variables are correlated or scales differ.</p></li>
<li class="fragment"><p>Useful in identifying outliers or in clustering when data is not isotropic.</p></li>
<li class="fragment"><p><a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.spatial.distance.mahalanobis.html">Python</a></p></li>
</ul>
</div></div>
</div>
</div>
</div>
</section></section>
<section>
<section id="clustering-2" class="title-slide slide level1 center">
<h1>Clustering</h1>

</section>
<section id="clustering-methods" class="slide level2">
<h2>Clustering methods</h2>
<div style="text-align: center;">
<iframe width="1200" height="400" src="https://https://info523-fall25-101-201.github.io/tables/model-cheatsheet.html" frameborder="1" style="background:white;"></iframe>
</div>
</section>
<section id="k-means-clustering" class="slide level2 smaller">
<h2>K-Means Clustering</h2>
<div class="panel-tabset">
<ul id="tabset-5" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-5-1">Visual</a></li><li><a href="#tabset-5-2">Formula</a></li><li><a href="#tabset-5-3">Key points</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1">
<div id="484bb94f" class="cell" data-execution_count="10">
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="11-unsupervised-1_files/figure-revealjs/cell-11-output-1.png" width="793" height="435"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-5-2">
<blockquote>
<p>The goal of K-Means is to minimize the variance within each cluster. The variance is measured as the sum of squared distances between each point and its corresponding cluster centroid. The objective function, which K-Means aims to minimize, can be defined as:</p>
</blockquote>
<p><span class="math inline">\(J = \sum_{i=1}^{k} \sum_{x \in C_i} ||x - \mu_i||^2\)</span></p>
<p><strong>Where</strong>:</p>
<ul>
<li class="fragment"><p><span class="math inline">\(J\)</span> is the objective function</p></li>
<li class="fragment"><p><span class="math inline">\(k\)</span> is the number of clusters</p></li>
<li class="fragment"><p><span class="math inline">\(C_i\)</span> is the set of points belonging to a cluster <span class="math inline">\(i\)</span>.</p></li>
<li class="fragment"><p><span class="math inline">\(x\)</span> is a point in the cluster <span class="math inline">\(C_i\)</span></p></li>
<li class="fragment"><p><span class="math inline">\(||x - \mu_i||^2\)</span> is the squared Euclidean distance between a point <span class="math inline">\(x\)</span> and the centroid <span class="math inline">\(\mu_i\)</span>​, which measures the dissimilarity between them.</p></li>
</ul>
</div>
<div id="tabset-5-3">
<ul>
<li><p><strong>Initialization</strong>: Randomly selects <span class="math inline">\(k\)</span> initial centroids.</p></li>
<li><p><strong>Assignment Step</strong>: Assigns each data point to the closest centroid based on Euclidean distance.</p></li>
<li><p><strong>Update Step</strong>: Recalculates centroids as the mean of assigned points in each cluster.</p></li>
<li><p><strong>Convergence</strong>: Iterates until the centroids stabilize (minimal change from one iteration to the next).</p></li>
<li><p><strong>Objective</strong>: Minimizes the within-cluster sum of squares (WCSS), the sum of squared distances between points and their corresponding centroid.</p></li>
<li><p><strong>Optimal</strong> <span class="math inline">\(k\)</span>: Determined experimentally, often using methods like the Elbow Method.</p></li>
<li><p><strong>Sensitivity</strong>: Results can vary based on initial centroid selection; techniques like “k-means++” improve initial centroid choices.</p></li>
<li><p><strong>Efficiency</strong>: Generally good, but worsens with increasing <span class="math inline">\(k\)</span> and data dimensionality; sensitive to outliers.</p></li>
</ul>
</div>
</div>
</div>
</section>
<section id="k-medians-clustering" class="slide level2 smaller">
<h2>K-Medians Clustering</h2>
<div class="panel-tabset">
<ul id="tabset-6" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-6-1">Visual</a></li><li><a href="#tabset-6-2">Formula</a></li><li><a href="#tabset-6-3">Key points</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1">
<div id="d9cda9e0" class="cell" data-execution_count="11">
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="11-unsupervised-1_files/figure-revealjs/cell-12-output-1.png" width="793" height="435"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-6-2">
<p><span class="math inline">\(\min \sum_{i=1}^{k} \sum_{x \in C_i} ||x - m_i||_1\)</span></p>
<ul>
<li><p><span class="math inline">\(k\)</span> is the number of clusters.</p></li>
<li><p><span class="math inline">\(C_i\)</span>​ represents the data points in cluster <span class="math inline">\(i\)</span>.</p></li>
<li><p><span class="math inline">\(x\)</span> is a point within cluster <span class="math inline">\(C_i\)</span>​.</p></li>
<li><p><span class="math inline">\(m_i\)</span>​ is the median of the data points in cluster <span class="math inline">\(i\)</span>, replacing the mean from K-Means.</p></li>
<li><p><span class="math inline">\(||x - \mu_i||_1\)</span> denotes the Manhattan distance (L1 norm) between point <span class="math inline">\(x\)</span> and median <span class="math inline">\(m_i\)</span>​.</p></li>
</ul>
</div>
<div id="tabset-6-3">
<ul>
<li class="fragment"><p><strong>Initialization</strong>: Randomly selects <span class="math inline">\(k\)</span> initial medians.</p></li>
<li class="fragment"><p><strong>Assignment Step</strong>: Assigns each data point to the closest median based on some distance metric, typically Manhattan distance.</p></li>
<li class="fragment"><p><strong>Update Step</strong>: Recalculates medians as the median of assigned points in each cluster.</p></li>
<li class="fragment"><p><strong>Convergence</strong>: Iterates until the medians stabilize (minimal change from one iteration to the next).</p></li>
<li class="fragment"><p><strong>Objective</strong>: Minimizes the within-cluster sum of absolute deviations (WSAD), the sum of absolute differences between points and their corresponding median.</p></li>
<li class="fragment"><p><strong>Optimal</strong> <span class="math inline">\(k\)</span>: Determined experimentally, often using methods like the Elbow Method.</p></li>
<li class="fragment"><p><strong>Sensitivity</strong>: Results can vary based on initial median selection; techniques like “k-medians++” may improve initial choices.</p></li>
<li class="fragment"><p><strong>Efficiency</strong>: Generally good, but can worsen with increasing <span class="math inline">\(k\)</span> and data dimensionality; often more robust to outliers compared to k-means.</p></li>
</ul>
</div>
</div>
</div>
</section>
<section id="k-means-vs.-k-medians-clustering" class="slide level2 smaller">
<h2>K-Means vs.&nbsp;K-Medians clustering</h2>
<p><strong>K-Means Clustering</strong>:</p>
<ul>
<li class="fragment"><p>Groups data by minimizing the variance within clusters.</p></li>
<li class="fragment"><p>Adopts the mean as the cluster center.</p></li>
<li class="fragment"><p>Prone to the impact of outliers.</p></li>
<li class="fragment"><p>Effective for locations in high-dimensional spaces and for “spherical” cluster shapes.</p></li>
</ul>
<p><strong>K-Median Clustering</strong>:</p>
<ul>
<li class="fragment"><p>Prioritizes the minimization of the sum of absolute deviations.</p></li>
<li class="fragment"><p>Adopts the median as the cluster center.</p></li>
<li class="fragment"><p>More robust to outliers than K-Means.</p></li>
<li class="fragment"><p>Bets for non-spherical data, and effectively manages the distortion in distributions.</p></li>
</ul>
</section>
<section id="choosing-the-right-number-of-clusters" class="slide level2 smaller">
<h2>Choosing the right number of clusters</h2>
<p><strong>Four main methods:</strong></p>
<ul>
<li class="fragment"><p><strong>Elbow Method</strong></p>
<ul>
<li class="fragment">Identifies the <span class="math inline">\(k\)</span> at which the within-cluster sum of squares (WCSS) starts to diminish more slowly.</li>
</ul></li>
<li class="fragment"><p><strong>Silhouette Score</strong></p>
<ul>
<li class="fragment">Measures how similar an object is to its own cluster compared to other clusters.</li>
</ul></li>
<li class="fragment"><p><strong>Davies-Bouldin Index</strong></p>
<ul>
<li class="fragment">Evaluates intra-cluster similarity and inter-cluster differences.</li>
</ul></li>
<li class="fragment"><p><strong>Calinski-Harabasz Index (Variance Ratio Criterion)</strong></p>
<ul>
<li class="fragment">Measures the ratio of the sum of between-clusters dispersion and of intra-cluster dispersion for all clusters.</li>
</ul></li>
<li class="fragment"><p><strong>BIC</strong></p>
<ul>
<li class="fragment">Identifies the optimal number of clusters by penalizing models for excessive parameters, striking a balance between simplicity and accuracy.</li>
</ul></li>
</ul>
</section>
<section id="elbow-method" class="slide level2 smaller">
<h2>Elbow Method</h2>
<div class="panel-tabset">
<ul id="tabset-7" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-7-1">Visual</a></li><li><a href="#tabset-7-2">Pros + Cons</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1">
<div id="0efbba79" class="cell" data-execution_count="12">
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="11-unsupervised-1_files/figure-revealjs/cell-13-output-1.png" width="828" height="529"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-7-2">
<p><strong>Pros:</strong></p>
<ul>
<li class="fragment"><p><strong>Simple and easy to understand</strong>: Requires minimal statistical knowledge.</p></li>
<li class="fragment"><p><strong>Clear graphical representation</strong>: Helps intuitively identify the optimal number of clusters.</p></li>
<li class="fragment"><p><strong>Versatile</strong>: Applicable to various clustering algorithms.</p></li>
</ul>
<p><strong>Cons:</strong></p>
<ul>
<li class="fragment"><p><strong>Subjective</strong>: The “elbow” point can be ambiguous, leading to different interpretations.</p></li>
<li class="fragment"><p><strong>Not ideal for all datasets</strong>: Difficulty in identifying a clear elbow in datasets with gradual variance reduction.</p></li>
<li class="fragment"><p><strong>Computationally expensive</strong>: For large datasets, calculating WCSS for many values of <span class="math inline">\(k\)</span> can be resource-intensive.</p></li>
<li class="fragment"><p><strong>Sensitive to initialization</strong>: The initial placement of centroids can influence the identification of the elbow point.</p></li>
</ul>
</div>
</div>
</div>
</section>
<section id="silhouette-score" class="slide level2 smaller">
<h2>Silhouette Score</h2>
<div class="panel-tabset">
<ul id="tabset-8" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-8-1">Visual</a></li><li><a href="#tabset-8-2">Formula</a></li><li><a href="#tabset-8-3">Pros + Cons</a></li></ul>
<div class="tab-content">
<div id="tabset-8-1">
<div id="c8294bd1" class="cell" data-execution_count="13">
<div class="cell-output cell-output-stdout">
<pre><code>For 3 clusters Silhouetter Score: 0.551</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="11-unsupervised-1_files/figure-revealjs/cell-14-output-2.png" width="646" height="447"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-8-2">
<p><span class="math inline">\(s(i) = \frac{b(i) - a(i)}{\max\{a(i), b(i)\}}\)</span></p>
<ul>
<li class="fragment"><p><span class="math inline">\(a\)</span> is the mean distance between a sample and all other points in the same class.</p></li>
<li class="fragment"><p><span class="math inline">\(b\)</span> is the mean distance between a sample and all other points in the next nearest cluster.</p></li>
</ul>
</div>
<div id="tabset-8-3">
<p><strong>Pros:</strong></p>
<ul>
<li class="fragment"><p>The score provides insight into the distance between the resulting clusters.</p></li>
<li class="fragment"><p>Values range from -1 to 1, where a high value indicates that the object is well matched to its own cluster and poorly matched to neighboring clusters.</p></li>
</ul>
<p><strong>Cons:</strong></p>
<ul>
<li class="fragment"><p>Computationally expensive for large datasets.</p></li>
<li class="fragment"><p>Does not perform well with clusters of varying densities.</p></li>
</ul>
</div>
</div>
</div>
</section>
<section id="davies-bouldin-index" class="slide level2 smaller">
<h2>Davies-Bouldin Index</h2>
<div class="panel-tabset">
<ul id="tabset-9" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-9-1">Visual</a></li><li><a href="#tabset-9-2">Formula</a></li><li><a href="#tabset-9-3">Pros + Cons</a></li></ul>
<div class="tab-content">
<div id="tabset-9-1">
<div id="5fa854cf" class="cell" data-execution_count="14">
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="11-unsupervised-1_files/figure-revealjs/cell-15-output-1.png" width="821" height="533"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-9-2">
<p><span class="math inline">\(DBI = \frac{1}{k} \sum_{i=1}^{k} \max_{j \neq i} \left( \frac{\sigma_i + \sigma_j}{d(c_i, c_j)} \right)\)</span></p>
<p><strong>Where</strong>:</p>
<ul>
<li class="fragment"><p><span class="math inline">\(k\)</span> is the number of clusters</p></li>
<li class="fragment"><p><span class="math inline">\(\sigma_i\)</span> is the average distance of all points in cluster <span class="math inline">\(i\)</span> to the centroid of cluster <span class="math inline">\(i\)</span> (intra-cluster distance)</p></li>
<li class="fragment"><p><span class="math inline">\(d(c_i, c_j)\)</span> is the distance between centroids <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span></p></li>
<li class="fragment"><p>The ratio <span class="math inline">\(\frac{\sigma_i + \sigma_j}{d(c_i, c_j)}\)</span> reflects the similarity between clusters <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span>, with lower values indicating clusters are well-separated and compact.</p></li>
</ul>
</div>
<div id="tabset-9-3">
<p><strong>Pros:</strong></p>
<ul>
<li class="fragment"><p><strong>Intuitive</strong>: Easy to understand and interpret. A lower DBI value means better clustering.</p></li>
<li class="fragment"><p><strong>Versatile</strong>: Applicable to any distance metric used within the clustering algorithm.</p></li>
<li class="fragment"><p><strong>Useful for Comparing Models</strong>: Effective for comparing the performance of different clustering models on the same dataset.</p></li>
</ul>
<p><strong>Cons:</strong></p>
<ul>
<li class="fragment"><p><strong>Sensitivity to Cluster Density</strong>: May not perform well with clusters of varying densities, as it relies on the mean distances within clusters.</p></li>
<li class="fragment"><p><strong>Does Not Scale Well</strong>: Computationally expensive for large datasets due to the calculation of distances between all pairs of clusters.</p></li>
<li class="fragment"><p><strong>Ambiguity in Interpretation</strong>: While lower values are better, there’s no clear threshold below which clusters are considered ‘good’ or ‘optimal’.</p></li>
</ul>
</div>
</div>
</div>
</section>
<section id="calinski-harabasz-index" class="slide level2 smaller">
<h2>Calinski-Harabasz Index</h2>
<div class="panel-tabset">
<ul id="tabset-10" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-10-1">Visual</a></li><li><a href="#tabset-10-2">Formula</a></li><li><a href="#tabset-10-3">Pros + cons</a></li></ul>
<div class="tab-content">
<div id="tabset-10-1">
<div id="54e4dd9b" class="cell" data-execution_count="15">
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="11-unsupervised-1_files/figure-revealjs/cell-16-output-1.png" width="833" height="533"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-10-2">
<p><span class="math inline">\(CH = \frac{SS_B / (k - 1)}{SS_W / (n - k)}\)</span></p>
<p><strong>where</strong>:</p>
<ul>
<li class="fragment"><p><span class="math inline">\(CH\)</span> is the Calinski-Harabasz score.</p></li>
<li class="fragment"><p><span class="math inline">\(SS_B\)</span>​ is the between-cluster variance.</p></li>
<li class="fragment"><p><span class="math inline">\(SS_W\)</span>​ is the within-cluster variance.</p></li>
<li class="fragment"><p><span class="math inline">\(k\)</span> is the number of clusters.</p></li>
<li class="fragment"><p><span class="math inline">\(n\)</span> is the number of data points.</p></li>
</ul>
</div>
<div id="tabset-10-3">
<p><strong>Pros</strong>:</p>
<ul>
<li class="fragment"><p><strong>Clear Interpretation</strong>: High values indicate better-defined clusters.</p></li>
<li class="fragment"><p><strong>Computationally Efficient</strong>: Less resource-intensive than many alternatives.</p></li>
<li class="fragment"><p><strong>Scale-Invariant</strong>: Effective across datasets of varying sizes.</p></li>
<li class="fragment"><p><strong>No Labeled Data Required</strong>: Useful for unsupervised learning scenarios.</p></li>
</ul>
<p><strong>Cons</strong>:</p>
<ul>
<li class="fragment"><p><strong>Cluster Structure Bias</strong>: Prefers convex clusters of similar sizes.</p></li>
<li class="fragment"><p><strong>Sample Size Sensitivity</strong>: Can favor more clusters in larger datasets.</p></li>
<li class="fragment"><p><strong>Not Ideal for Overlapping Clusters</strong>: Assumes distinct, non-overlapping clusters.</p></li>
</ul>
</div>
</div>
</div>
</section>
<section id="bic" class="slide level2 smaller">
<h2>BIC</h2>
<div class="panel-tabset">
<ul id="tabset-11" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-11-1">Visual</a></li><li><a href="#tabset-11-2">Formula</a></li><li><a href="#tabset-11-3">Pros + cons</a></li></ul>
<div class="tab-content">
<div id="tabset-11-1">
<div id="5835c6ea" class="cell" data-execution_count="16">
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="11-unsupervised-1_files/figure-revealjs/cell-17-output-1.png" width="833" height="533"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-11-2">
<p><span class="math inline">\(\text{BIC} = -2 \ln(\hat{L}) + k \ln(n)\)</span></p>
<p><strong>where</strong>:</p>
<ul>
<li class="fragment"><p><span class="math inline">\(\hat{L}\)</span> is the maximized value of the likelihood function of the model,</p></li>
<li class="fragment"><p><span class="math inline">\(k\)</span> is the number of parameters in the model,</p></li>
<li class="fragment"><p><span class="math inline">\(n\)</span> is the number of observations.</p></li>
</ul>
</div>
<div id="tabset-11-3">
<p><strong>Pros</strong>:</p>
<ul>
<li><p><strong>Penalizes Complexity</strong>: Helps avoid overfitting by penalizing models with more parameters.</p></li>
<li><p><strong>Objective Selection</strong>: Facilitates choosing the model with the best balance between fit and simplicity.</p></li>
<li><p><strong>Applicability</strong>: Useful across various model types, including clustering and regression.</p></li>
</ul>
<p><strong>Cons</strong>:</p>
<ul>
<li><p><strong>Computationally Intensive</strong>: Requires fitting multiple models to calculate, which can be resource-heavy.</p></li>
<li><p><strong>Sensitivity to Model Assumptions</strong>: Performance depends on the underlying assumptions of the model being correct.</p></li>
<li><p><strong>Not Always Intuitive</strong>: Determining the absolute best model may still require domain knowledge and additional diagnostics.</p></li>
</ul>
</div>
</div>
</div>
</section>
<section id="systematic-comparison-equal-clusters" class="slide level2 smaller">
<h2>Systematic comparison: Equal clusters</h2>
<div class="panel-tabset">
<ul id="tabset-12" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-12-1">Elbow</a></li><li><a href="#tabset-12-2">Davies-Boulin</a></li><li><a href="#tabset-12-3">Silhouette</a></li><li><a href="#tabset-12-4">Calinski-Harabasz</a></li><li><a href="#tabset-12-5">BIC</a></li></ul>
<div class="tab-content">
<div id="tabset-12-1">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/equally-sized-elbow.png" class="quarto-figure quarto-figure-center" width="896"></p>
</figure>
</div>
</div>
<div id="tabset-12-2">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/equally-sized-davies-bouldin.png" class="quarto-figure quarto-figure-center" width="896"></p>
</figure>
</div>
</div>
<div id="tabset-12-3">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/equally-sized-silhouette.png" class="quarto-figure quarto-figure-center" width="896"></p>
</figure>
</div>
</div>
<div id="tabset-12-4">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/equally-sized-calinski-harabasz.png" class="quarto-figure quarto-figure-center" width="896"></p>
</figure>
</div>
</div>
<div id="tabset-12-5">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/equally-sized-bic.png" class="quarto-figure quarto-figure-center" width="896"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="systematic-comparison-unequal-clusters" class="slide level2 smaller">
<h2>Systematic comparison: Unequal clusters</h2>
<div class="panel-tabset">
<ul id="tabset-13" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-13-1">Elbow</a></li><li><a href="#tabset-13-2">Davies-Boulin</a></li><li><a href="#tabset-13-3">Silhouette</a></li><li><a href="#tabset-13-4">Calinski-Harabasz</a></li><li><a href="#tabset-13-5">BIC</a></li></ul>
<div class="tab-content">
<div id="tabset-13-1">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/unequally-sized-elbow.png" class="quarto-figure quarto-figure-center" width="896"></p>
</figure>
</div>
</div>
<div id="tabset-13-2">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/unequally-sized-davies-bouldin.png" class="quarto-figure quarto-figure-center" width="896"></p>
</figure>
</div>
</div>
<div id="tabset-13-3">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/unequally-sized-silhouette.png" class="quarto-figure quarto-figure-center" width="896"></p>
</figure>
</div>
</div>
<div id="tabset-13-4">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/unequally-sized-calinski-harabasz.png" class="quarto-figure quarto-figure-center" width="896"></p>
</figure>
</div>
</div>
<div id="tabset-13-5">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/unequally-sized-bic.png" class="quarto-figure quarto-figure-center" width="896"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="systematic-comparison---accuracy" class="slide level2">
<h2>Systematic comparison - accuracy</h2>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/systematic-comparison.png" class="quarto-figure quarto-figure-center" width="692"></p>
</figure>
</div>
</section>
<section id="k-means-clustering-applied" class="slide level2 smaller">
<h2>K-Means Clustering: applied</h2>
<div class="panel-tabset">
<ul id="tabset-14" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-14-1">Model summary</a></li><li><a href="#tabset-14-2">Visualize results</a></li></ul>
<div class="tab-content">
<div id="tabset-14-1">
<div id="9e0df779" class="cell" data-execution_count="17">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a></a><span class="co"># K-Means Clustering</span></span>
<span id="cb12-2"><a></a>kmeans <span class="op">=</span> KMeans(n_clusters <span class="op">=</span> <span class="dv">5</span>, random_state <span class="op">=</span> <span class="dv">0</span>)  <span class="co"># Adjust n_clusters as needed</span></span>
<span id="cb12-3"><a></a>kmeans.fit(mlb_preprocessed_df)</span>
<span id="cb12-4"><a></a>clusters <span class="op">=</span> kmeans.predict(mlb_preprocessed_df)</span>
<span id="cb12-5"><a></a></span>
<span id="cb12-6"><a></a><span class="co"># Adding cluster labels to the DataFrame</span></span>
<span id="cb12-7"><a></a>mlb_preprocessed_df[<span class="st">'Cluster'</span>] <span class="op">=</span> clusters</span>
<span id="cb12-8"><a></a></span>
<span id="cb12-9"><a></a><span class="co"># Evaluate clustering performance</span></span>
<span id="cb12-10"><a></a>silhouette_avg <span class="op">=</span> silhouette_score(mlb_preprocessed, clusters)</span>
<span id="cb12-11"><a></a><span class="bu">print</span>(<span class="st">"For n_clusters ="</span>, <span class="dv">5</span>, <span class="ss">f"The average silhouette_score is : </span><span class="sc">{</span>silhouette_avg<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb12-12"><a></a><span class="bu">print</span>(<span class="st">""</span>)</span>
<span id="cb12-13"><a></a></span>
<span id="cb12-14"><a></a><span class="co"># Model Summary</span></span>
<span id="cb12-15"><a></a><span class="bu">print</span>(<span class="st">"Cluster Centers:</span><span class="ch">\n</span><span class="st">"</span>, kmeans.cluster_centers_)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>For n_clusters = 5 The average silhouette_score is : 0.283

Cluster Centers:
 [[-5.39609837e-01 -5.02836911e-01 -5.18899682e-01 -5.23917640e-01
  -5.14812799e-01 -3.89394270e-01 -4.95709868e-01 -5.22793433e-01
  -4.78791120e-01 -4.58484221e-01 -3.19933197e-01 -3.76064850e-01
   2.01292991e-01  3.36219513e-01  2.94309908e-02  1.66023612e-01
   2.96610169e-02  3.81355932e-02  5.08474576e-02  2.54237288e-02
   4.23728814e-02  4.66101695e-02  1.27118644e-02  2.54237288e-02
   1.69491525e-02  1.69491525e-02  1.69491525e-02  2.96610169e-02
   3.38983051e-02  2.54237288e-02  6.35593220e-02  3.81355932e-02
   2.11864407e-02  6.35593220e-02  2.11864407e-02  2.96610169e-02
   3.81355932e-02  4.66101695e-02  3.81355932e-02  2.96610169e-02
   2.54237288e-02  5.93220339e-02  2.54237288e-02  3.38983051e-02
   2.54237288e-02  2.96610169e-02  1.69491525e-02  9.32203390e-02
   5.93220339e-02  1.65254237e-01  6.77966102e-02 -7.80625564e-18
   4.23728814e-02  4.19491525e-01  5.93220339e-02  7.62711864e-02]
 [ 1.92557040e+00  2.11614058e+00  2.25725574e+00  2.17159311e+00
   2.14697517e+00  1.88905923e+00  2.04509799e+00  2.11085078e+00
   2.12293189e+00  1.95422267e+00  1.82180024e+00  1.82637019e+00
   8.94034992e-01  9.56549852e-01  1.08387736e+00  1.05520915e+00
   5.03597122e-02  4.31654676e-02  1.43884892e-02  4.31654676e-02
   4.31654676e-02  3.59712230e-02  3.59712230e-02  4.31654676e-02
   2.87769784e-02  3.59712230e-02  2.87769784e-02  1.43884892e-02
   3.59712230e-02  5.75539568e-02  2.15827338e-02  4.31654676e-02
   1.43884892e-02  2.15827338e-02  5.03597122e-02  4.31654676e-02
   2.87769784e-02  2.87769784e-02  2.87769784e-02  4.31654676e-02
   7.19424460e-03  2.15827338e-02  4.31654676e-02  2.87769784e-02
   2.15827338e-02  4.31654676e-02  1.07913669e-01  1.51079137e-01
   1.07913669e-01  2.15827338e-02  1.51079137e-01  1.43884892e-02
   1.72661871e-01  7.19424460e-03  1.22302158e-01  1.43884892e-01]
 [-8.64780245e-02 -1.49140931e-01 -1.81680267e-01 -1.65184901e-01
  -1.74480102e-01 -7.09405304e-02 -2.08431270e-01 -1.78288732e-01
  -1.68120995e-01 -9.92878111e-02 -1.25924439e-01 -1.32575095e-01
   1.11622394e+00  1.04808532e+00  1.11572635e+00  1.11431959e+00
   2.82485876e-02  3.95480226e-02  3.95480226e-02  2.82485876e-02
   2.82485876e-02  3.38983051e-02  5.64971751e-02  5.08474576e-02
   3.38983051e-02  3.95480226e-02  1.69491525e-02  3.95480226e-02
   5.64971751e-02  2.82485876e-02  3.38983051e-02  3.38983051e-02
   1.12994350e-02  2.82485876e-02  2.82485876e-02  2.82485876e-02
   2.82485876e-02  2.82485876e-02  1.69491525e-02  2.82485876e-02
   5.08474576e-02  1.69491525e-02  3.38983051e-02  2.25988701e-02
   5.08474576e-02  3.95480226e-02  6.77966102e-02  9.03954802e-02
   1.01694915e-01  2.14689266e-01  1.35593220e-01 -6.93889390e-18
   1.01694915e-01  1.41242938e-01  8.47457627e-02  6.21468927e-02]
 [-6.49011289e-01 -6.78780505e-01 -6.29422546e-01 -6.50062853e-01
  -6.17484560e-01 -4.39676439e-01 -5.47164942e-01 -6.18568330e-01
  -5.92287373e-01 -6.74773770e-01 -3.87607717e-01 -4.25297020e-01
  -9.58393345e-01 -1.02727988e+00 -9.63474765e-01 -1.01639690e+00
   4.51127820e-02  4.69924812e-02  2.25563910e-02  3.19548872e-02
   3.94736842e-02  3.75939850e-02  2.63157895e-02  3.19548872e-02
   2.06766917e-02  4.51127820e-02  2.63157895e-02  2.81954887e-02
   3.00751880e-02  4.88721805e-02  3.00751880e-02  3.75939850e-02
   2.25563910e-02  3.75939850e-02  2.81954887e-02  3.57142857e-02
   3.00751880e-02  2.63157895e-02  3.75939850e-02  3.00751880e-02
   3.75939850e-02  3.19548872e-02  3.00751880e-02  2.81954887e-02
   3.38345865e-02  4.13533835e-02  1.87969925e-03  5.63909774e-03
  -6.24500451e-17  5.63909774e-03  3.75939850e-03  2.60208521e-18
   1.87969925e-03  9.71804511e-01  5.63909774e-03  3.75939850e-03]
 [ 1.18427017e+00  1.13997389e+00  9.44688061e-01  1.05841014e+00
   9.80919546e-01  4.07430932e-01  8.63994585e-01  1.02476586e+00
   8.75061667e-01  1.14580061e+00  2.72956622e-01  4.54890614e-01
   7.55471035e-01  7.99427741e-01  8.46668517e-01  8.47488920e-01
   2.15053763e-02  3.22580645e-02  4.30107527e-02  3.22580645e-02
   3.22580645e-02  2.15053763e-02  3.22580645e-02  1.61290323e-02
   3.76344086e-02  2.15053763e-02  4.83870968e-02  3.76344086e-02
   1.61290323e-02  2.68817204e-02  2.15053763e-02  4.30107527e-02
   5.91397849e-02  4.30107527e-02  3.22580645e-02  2.15053763e-02
   4.83870968e-02  3.22580645e-02  3.76344086e-02  3.22580645e-02
   4.83870968e-02  4.30107527e-02  2.68817204e-02  3.76344086e-02
   3.76344086e-02  1.61290323e-02  1.45161290e-01  1.12903226e-01
   1.39784946e-01  1.72043011e-01  8.60215054e-02  2.15053763e-02
   9.13978495e-02 -7.77156117e-16  1.45161290e-01  8.60215054e-02]]</code></pre>
</div>
</div>
</div>
<div id="tabset-14-2">
<div id="81a469cd" class="cell" data-execution_count="18">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a></a>pca <span class="op">=</span> PCA(n_components <span class="op">=</span> <span class="dv">2</span>)</span>
<span id="cb14-2"><a></a>mlb_pca <span class="op">=</span> pca.fit_transform(mlb_preprocessed)</span>
<span id="cb14-3"><a></a>sns.scatterplot(x <span class="op">=</span> mlb_pca[:, <span class="dv">0</span>], y <span class="op">=</span> mlb_pca[:, <span class="dv">1</span>], hue <span class="op">=</span> clusters, alpha <span class="op">=</span> <span class="fl">0.75</span>, palette <span class="op">=</span> <span class="st">"colorblind"</span>)</span>
<span id="cb14-4"><a></a>plt.title(<span class="st">'MLB Players Clustered (PCA-reduced Features)'</span>)</span>
<span id="cb14-5"><a></a>plt.xlabel(<span class="st">'PCA 1'</span>)</span>
<span id="cb14-6"><a></a>plt.ylabel(<span class="st">'PCA 2'</span>)</span>
<span id="cb14-7"><a></a>plt.legend(title <span class="op">=</span> <span class="st">'Cluster'</span>)</span>
<span id="cb14-8"><a></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="11-unsupervised-1_files/figure-revealjs/cell-19-output-1.png" width="668" height="496"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="live-coding-apply-k-medians-clustering" class="slide level2 smaller">
<h2>Live coding: apply K-Medians Clustering</h2>
<div id="4086d2da" class="cell" data-execution_count="19">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a></a><span class="im">from</span> sklearn_extra.cluster <span class="im">import</span> KMedoids</span>
<span id="cb15-2"><a></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> silhouette_score</span>
<span id="cb15-3"><a></a><span class="im">from</span> sklearn.decomposition <span class="im">import</span> PCA</span>
<span id="cb15-4"><a></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb15-5"><a></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb15-6"><a></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb15-7"><a></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb15-8"><a></a></span>
<span id="cb15-9"><a></a><span class="co"># Using 'mlb_preprocessed_df' is your DataFrame after preprocessing</span></span>
<span id="cb15-10"><a></a>data <span class="op">=</span> mlb_preprocessed_df.to_numpy()</span>
<span id="cb15-11"><a></a></span>
<span id="cb15-12"><a></a><span class="co"># Create KMedoids instance with 5 clusters and Manhattan distance (L1)</span></span>
<span id="cb15-13"><a></a>kmedoids_instance <span class="op">=</span> KMedoids(n_clusters <span class="op">=</span> <span class="dv">5</span>, metric <span class="op">=</span> <span class="st">'manhattan'</span>, random_state <span class="op">=</span> <span class="dv">42</span>)</span>
<span id="cb15-14"><a></a></span>
<span id="cb15-15"><a></a><span class="co"># Fit the model and predict cluster labels</span></span>
<span id="cb15-16"><a></a>cluster_labels <span class="op">=</span> kmedoids_instance.fit_predict(data)</span>
<span id="cb15-17"><a></a></span>
<span id="cb15-18"><a></a><span class="co"># Assign cluster labels to each record in DataFrame</span></span>
<span id="cb15-19"><a></a>mlb_preprocessed_df[<span class="st">'Cluster'</span>] <span class="op">=</span> cluster_labels</span>
<span id="cb15-20"><a></a></span>
<span id="cb15-21"><a></a><span class="co"># Evaluate clustering performance using silhouette score</span></span>
<span id="cb15-22"><a></a>silhouette_avg <span class="op">=</span> silhouette_score(data, cluster_labels)</span>
<span id="cb15-23"><a></a><span class="bu">print</span>(<span class="ss">f"For n_clusters = 5, The average silhouette_score is : </span><span class="sc">{</span>silhouette_avg<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb15-24"><a></a></span>
<span id="cb15-25"><a></a><span class="co"># Displaying the medians (centroids) of the clusters</span></span>
<span id="cb15-26"><a></a><span class="co"># Note: KMedoids uses actual data points as centers, not the mean or median of the cluster.</span></span>
<span id="cb15-27"><a></a><span class="bu">print</span>(<span class="st">"Cluster Medians (Centers):</span><span class="ch">\n</span><span class="st">"</span>, kmedoids_instance.cluster_centers_)</span>
<span id="cb15-28"><a></a></span>
<span id="cb15-29"><a></a><span class="co"># Visualize using PCA for dimensionality reduction</span></span>
<span id="cb15-30"><a></a>pca <span class="op">=</span> PCA(n_components <span class="op">=</span> <span class="dv">2</span>)</span>
<span id="cb15-31"><a></a>mlb_pca <span class="op">=</span> pca.fit_transform(data)</span>
<span id="cb15-32"><a></a></span>
<span id="cb15-33"><a></a><span class="co"># Plotting the clusters</span></span>
<span id="cb15-34"><a></a>sns.scatterplot(x <span class="op">=</span> mlb_pca[:, <span class="dv">0</span>], y <span class="op">=</span> mlb_pca[:, <span class="dv">1</span>], hue <span class="op">=</span> cluster_labels, alpha <span class="op">=</span> <span class="fl">0.75</span>, palette <span class="op">=</span> <span class="st">"colorblind"</span>)</span>
<span id="cb15-35"><a></a>plt.title(<span class="st">'MLB Players Clustered (PCA-reduced Features)'</span>)</span>
<span id="cb15-36"><a></a>plt.xlabel(<span class="st">'PCA 1'</span>)</span>
<span id="cb15-37"><a></a>plt.ylabel(<span class="st">'PCA 2'</span>)</span>
<span id="cb15-38"><a></a>plt.legend(title <span class="op">=</span> <span class="st">'Cluster'</span>)</span>
<span id="cb15-39"><a></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="conclusions" class="slide level2 smaller">
<h2>Conclusions</h2>
<ul>
<li class="fragment"><p><strong>Unsupervised Learning</strong>: Explores data to find structure in the form of clusters without predefined labels or outcomes.</p></li>
<li class="fragment"><p><strong>Clustering Use Cases</strong>: Includes recommender systems, anomaly detection, genetics, and customer segmentation.</p></li>
<li class="fragment"><p><strong>Clustering Algorithms</strong>: K-Means and K-Medians are highlighted for their utility in grouping data based on similarity measures.</p></li>
<li class="fragment"><p><strong>Choosing the Right Number of Clusters</strong>: Techniques like the Elbow Method, Silhouette Score, Davies-Bouldin Index, Calinski-Harabasz Index, and BIC are critical for determining the optimal cluster count.</p></li>
<li class="fragment"><p><strong>Similarity and Dissimilarity Measures</strong>: Essential in clustering, with methods including Euclidean, Manhattan, Cosine, Jaccard, and Mahalanobis distances.</p></li>
<li class="fragment"><p><strong>Evaluation Metrics</strong>: Silhouette Score, Davies-Bouldin Index, and Calinski-Harabasz Index help assess clustering quality, focusing on intra-cluster cohesion and inter-cluster separation.</p></li>
</ul>


</section></section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<p><img src="../logo.png" class="slide-logo"></p>
<div class="footer footer-default">
<p><a href="https://info523-fall25-101-201.github.io/">🔗 github.io</a></p>
</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../../../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../../../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../../../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../../../site_libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="../../../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../../../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../../../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../../../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../../../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"8\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'fade',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
            const codeEl = trigger.previousElementSibling.cloneNode(true);
            for (const childEl of codeEl.children) {
              if (isCodeAnnotation(childEl)) {
                childEl.remove();
              }
            }
            return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp('/' + window.location.host + '/');
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    

</body></html>